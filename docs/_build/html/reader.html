<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Write LAMMPS dump/data format header" href="writer.html" /><link rel="prev" title="Welcome to py_Matters_Simulations’s documentation!" href="index.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Reading Computer Simulations Snapshots - py_Matters_Simulations documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #1e88e5;
  --color-brand-content: #1e88e5;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">py_Matters_Simulations  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">py_Matters_Simulations  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Reading Computer Simulations Snapshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="writer.html">Write LAMMPS dump/data format header</a></li>
<li class="toctree-l1"><a class="reference internal" href="neighbors.html">Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="gr.html">Pair Correlation Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="sq.html">Structure Factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_2d.html">Bond Orientational Order Parameters at 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_3d.html">Bond Orientational Order Parameters at 3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html">static orderings</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html#local-tetrahedral-order-q-rm-tetra">1. Local tetrahedral order <span class="math notranslate nohighlight">\(q_{\rm tetra}\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html#packing-capability-theta-o">2. Packing capability <span class="math notranslate nohighlight">\(\Theta_o\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html#pair-entropy-s-2">3. Pair entropy <span class="math notranslate nohighlight">\(S_2\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html#gyration-tensor-of-a-group">4. Gyration tensor of a group</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html#nematic-order">5. Nematic order</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamics.html">Dynamical properties at two &amp; three dimensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">Hessian matrix calculation and diagonalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html#pair-interactions"><span class="xref myst">1. Pair interactions</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html#hessian-matrix"><span class="xref myst">2. Hessian matrix</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html#pairinteractions-class">1. <code class="docutils literal notranslate"><span class="pre">PairInteractions</span></code> class</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html#ii-hessian-matrix">II. Hessian matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html">vector analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html#participation-ratio">1. participation ratio</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html#local-vector-alignment">2. local vector alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html#phase-quotient">3. phase quotient</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html#divergence-and-curl">4. divergence and curl</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html#vibrability">5. vibrability</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html#vector-decompostion-structure-factor">6. vector decompostion structure factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html#vectors-fourier-transformaiton-and-their-time-correlations">7. vectors Fourier transformaiton and their time correlations</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">util functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html#i-funcs">I. funcs</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html#ii-remove-pbc">II. Remove PBC</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html#id7">III. geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html#id17">IV. wavevector</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html#id30">V. Fast Fourier Transformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html#id34">VI. Spherical Harmonics</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html#id38">VII. Coarse Graining</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/reader.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="reading-computer-simulations-snapshots">
<h1>Reading Computer Simulations Snapshots<a class="headerlink" href="#reading-computer-simulations-snapshots" title="Link to this heading">¶</a></h1>
<p>This module read-in the static or time evolution of the particle positions (snapshots or trajectories) encapsulated in a simulation box from various simulators for materials science, chemistry, and physics etc. The popular ones includes but not limit yo LAMMPS and Hoomd-blue. This module is very flexible for future extension, just by adding suitable format reading of the simulation outputs. For example, the atomic/molecular configurations from <em>ab-initio</em> calculations (DFT) and Gromacs, and any others. This module is the base of all of the other physical calculations. As long as the simulation box information were read properly, they can be used for additional calculations. That means, we are trying to “forget about” the specific simulation box, but transform it to a specific data structures.</p>
<p>The main functions are captured by the module <code class="docutils literal notranslate"><span class="pre">reader</span></code>, in which there are several reading methods, listed currently as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dump_reader</span></code> [main function to call other methods]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GSD_reader_helper</span></code> [specific for Hoomd-blue]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lammps_reader_helper</span></code> [specific for LAMMPS]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reader_utils</span></code> [define output data structures]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simulation_log</span></code> [simulation log reading, now only for LAMMPS]</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">dump_reader</span></code> is a main stream to include all other methods, which is useful for general purpose. The other helper functions are designed for specific purpose if any.</p>
<p>The typical features of <code class="docutils literal notranslate"><span class="pre">reader</span></code> are:</p>
<ol class="arabic">
<li><p>There are now four types of input snapshots format supported, which is specified by the <code class="docutils literal notranslate"><span class="pre">filetype</span></code> argument when initializing <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code>. Internally, this class calls the other specific methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filetype=DumpFileType.LAMMPS</span></code>: Atomistic system in LAMMPS, by calling <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> or <code class="docutils literal notranslate"><span class="pre">reader.lammps_reader_helper.read_lammps_wrapper</span> </code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filetype=DumpFileType.LAMMPSCENTER</span></code>: Molecular system in LAMMPS, by calling <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> or <code class="docutils literal notranslate"><span class="pre">reader.lammps_reader_helper.read_lammps_centertype_wrapper</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filetype=DumpFileType.GSD</span></code>: Static properties in Hoomd-blue, GSD file, by calling <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> or <code class="docutils literal notranslate"><span class="pre">reader.GSD_reader_helper.read_GSD_wrapper</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filetype=DumpFileType.GSD_DCD</span></code>: Dynamic properties in Hoomd-blue, both GSD and DCD files, by calling <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> or <code class="docutils literal notranslate"><span class="pre">reader.GSD_reader_helper.read_GSD_DCD_wrapper</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filetype=DumpFileType.LAMMPSVECTOR</span></code>: additional columns other than the positions in the dump file. For example, the dump is “id type x y vx vy”, this module is working to read “vx, vy” by giving <code class="docutils literal notranslate"><span class="pre">columnsids=[4,</span> <span class="pre">5]</span></code>. This can be arbitray dimensions for the additional columns. This information is stored by the <code class="docutils literal notranslate"><span class="pre">positions</span></code> attribute.</p></li>
</ul>
</li>
<li><p>Supports any dimensionality. General cases include the two-dimensional (LAMMPS dump file format <em><strong>id type x y</strong></em>) and three-dimensional snapshots (LAMMPS dump file format <em><strong>id type x y z</strong></em>). As long as the input format includes <em><strong>id type</strong></em>, only dimensional positions will be read-in and the other columns will be neglected. For example, for a two-dimensional system, the input format can be <em><strong>id type x y z xx yy zz nn…</strong></em>, the positions <em><strong>(x y)</strong></em> can be read properly. To read additional columns, use <code class="docutils literal notranslate"><span class="pre">DumpFileType.LAMMPSVECTOR</span></code> instead.</p></li>
<li><p>Supports both orthogonal and triclinic cells with the use of H-matrix to deal with the periodic boundary conditions. As long as the simulator supports these two types cell, the module can process it properly. For a triclinic box, it converts the bounding box back into the trilinic box parameters by refering to ‘https://docs.lammps.org/Howto_triclinic.html’:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">xlo</span> <span class="o">=</span> <span class="n">xlo_bound</span> <span class="o">-</span> <span class="n">MIN</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">xy</span><span class="p">,</span><span class="n">xz</span><span class="p">,</span><span class="n">xy</span><span class="o">+</span><span class="n">xz</span><span class="p">)</span>
<span class="n">xhi</span> <span class="o">=</span> <span class="n">xhi_bound</span> <span class="o">-</span> <span class="n">MAX</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">xy</span><span class="p">,</span><span class="n">xz</span><span class="p">,</span><span class="n">xy</span><span class="o">+</span><span class="n">xz</span><span class="p">)</span>
<span class="n">ylo</span> <span class="o">=</span> <span class="n">ylo_bound</span> <span class="o">-</span> <span class="n">MIN</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">yz</span><span class="p">)</span>
<span class="n">yhi</span> <span class="o">=</span> <span class="n">yhi_bound</span> <span class="o">-</span> <span class="n">MAX</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">yz</span><span class="p">)</span>
<span class="n">zlo</span> <span class="o">=</span> <span class="n">zlo_bound</span>
<span class="n">zhi</span> <span class="o">=</span> <span class="n">zhi_bound</span>
</pre></div>
</div>
</li>
</ol>
<section id="input-arguments">
<h2>Input Arguments<a class="headerlink" href="#input-arguments" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filename</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the name of dump file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ndim</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): dimensionality</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filetype</span></code> (<code class="docutils literal notranslate"><span class="pre">DumpFileType</span></code>): input dump format, defined in <code class="docutils literal notranslate"><span class="pre">reader.reader_utils</span></code>, including the following format:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DumpFileType.LAMMPS</span></code> (<code class="docutils literal notranslate"><span class="pre">default</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DumpFileType.LAMMPSCENTER</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DumpFileType.GSD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DumpFileType.GSD_DCD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DumpFileType.LAMMPSVECTOR</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">moltypes</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>, optional): only used for molecular system in LAMMPS so far, default is <code class="docutils literal notranslate"><span class="pre">None</span></code>. To specify, for example, if the system has 5 types of atoms in which 1-3 is one type of molecules and 4-5 is the other, and type 3 and 5 are the center of mass. Then <code class="docutils literal notranslate"><span class="pre">moltypes</span></code> should be <code class="docutils literal notranslate"><span class="pre">{3:1,</span> <span class="pre">5:2}</span></code>. The keys <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">5]</span></code> of  <code class="docutils literal notranslate"><span class="pre">moltypes</span></code> are used to select specific atoms to present the corresponding molecules. The values <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2]</span></code> is used to record the type of molecules.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">columnsids</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): only used to read addtional columns in LAMMPS dump, default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ol>
</section>
<section id="return">
<h2>Return<a class="headerlink" href="#return" title="Link to this heading">¶</a></h2>
<p>The input simulation box will be transformed to a list of ‘digital’ snapshot, by returning <code class="docutils literal notranslate"><span class="pre">snapshots</span></code> object. It is a list of <code class="docutils literal notranslate"><span class="pre">snapshot</span></code> that has all of the configuration information. <code class="docutils literal notranslate"><span class="pre">snapshots</span></code> and <code class="docutils literal notranslate"><span class="pre">snapshot</span></code> are two data class defined in <code class="docutils literal notranslate"><span class="pre">reader.reader_utils</span></code>.  <code class="docutils literal notranslate"><span class="pre">snapshot</span></code> consists:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].timestep</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): simulation timestep at each snapshot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].nparticle</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): particle number from each snapshot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].particle_type</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle type in array in each snapshot. Additional columns information for <code class="docutils literal notranslate"><span class="pre">DumpFileType.LAMMPSVECTOR</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].positions</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle coordinates in array in each snapshot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].boxlength</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): box length in array in each snapshot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].boxbounds</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): box boundaries in array in each snapshot</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].realbounds</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): real box bounds of a triclinic box (optional)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots[n].hmatrix</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): h-matrix of the cells in each snapshot</p></li>
</ul>
<p>The information is stored in a list of which the elements are mainly numpy arrays. Particle-level information is referred by particle ID.</p>
</section>
<section id="important-notes">
<h2>Important Notes<a class="headerlink" href="#important-notes" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>In LAMMPS, <em><strong>x</strong></em>, <em><strong>xs</strong></em>, and <em><strong>xu</strong></em> format coordinates are acceptable. Such as with format The reduced <em><strong>xs</strong></em> will be rescaled to the absolute coordinates <em><strong>x</strong></em>.</p></li>
<li><p>For the <em><strong>xs</strong></em> and <em><strong>x</strong></em> types in orthogonal cells with periodic boundary conditions, particle coordinates are <strong>NOT</strong> warpped to the inside of the box by default, which could be changed by hand when necessary. In non-periodic boundary conditions, there should be no particles at the outside of the cell.</p></li>
<li><p>Snapshots should be stored in one file at this stage.</p></li>
<li><p>In Hoomd-blue, GSD and DCD files are acceptable. GSD file has all the information with periodic boundary conditions, while DCD has the unwarpped coordinates. GSD file has all the information with periodic boundary conditions, while DCD only has the particle positions. Normally only GSD file is needed . But if one wants to analyze the dynamical properties, the DCD file should be dumped accompanying the GSD file to get the unwarp coordinates. More specifically, all the information about the trajectory will be obtained from the GSD file except the particle positions which will be obtained from the DCD file. Therefore, the DCD and GSD files shall be dumped with the same period or concurrently. Another important point in this case is the file name of GSD and DCD. They should share the same name with the only difference of the last three string, ie. ‘GSD ’or ‘DCD’. For example, if the file name of GSD is <em><strong>dumpfile.GSD</strong></em> then the DCD file name must be <em><strong>dumpfile.DCD</strong></em>. To read the Hoomd-blue outputs, two new modules should be installed first: i) GSD; ii) mdtraj. These modules are available by conda.</p></li>
<li><p>The addtional columns are now readable from <code class="docutils literal notranslate"><span class="pre">DumpFileType.LAMMPSVECTOR</span></code> by specifying the column ids.</p></li>
</ol>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h2>
<p>Some dump files are provided in <code class="docutils literal notranslate"><span class="pre">tests/sample_test_data</span></code>.</p>
<ul>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">dump_reader</span></code> and specify <code class="docutils literal notranslate"><span class="pre">filetype</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>

<span class="n">readdump</span><span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="c1"># return the number of snapshots</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">nsnapshots</span>

<span class="c1"># return the timestep of the first snapshot</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timestep</span>

<span class="c1"># return the particle number of the first snapshot</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">nparticle</span>

<span class="c1"># return the particle type of the first snapshot</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle_type</span>

<span class="c1"># return the particle positions of the first snapshot</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>

<span class="c1"># return the boxlength of the first snapshot</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">boxlength</span>

<span class="c1"># return the boxbounds of the first snapshot</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">boxbounds</span>

<span class="c1"># return the realbounds of the first snapshot, for triclinic box</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">realbounds</span>

<span class="c1"># return the hmatrix of the first snapshot</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hmatrix</span>

<span class="c1"># get all the timesteps</span>
<span class="p">[</span><span class="n">snapshot</span><span class="o">.</span><span class="n">timestep</span> <span class="k">for</span> <span class="n">snapshot</span> <span class="ow">in</span> <span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>The user can also directly call the wrapper functions, such as,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.lammps_reader_helper</span> <span class="kn">import</span> <span class="n">read_lammps_wrapper</span>

<span class="n">snapshots</span> <span class="o">=</span> <span class="n">read_lammps_wrapper</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># return number of snapshots</span>
<span class="n">snapshots</span><span class="o">.</span><span class="n">nsnapshots</span>

<span class="c1"># return the particle positions of the first snapshot</span>
<span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>
</pre></div>
</div>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">reader.lammps_reader_helper.read_additions</span></code> can read additional columns in the lammps dump file. <code class="docutils literal notranslate"><span class="pre">ncol</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): specifying the column number starting from 0 (zero-based). <code class="docutils literal notranslate"><span class="pre">read_additions</span></code> returns a numpy array as shape [nsnapshots, nparticle] in float. For example, read <em><strong>order</strong></em> from <em><strong>id type x y z order</strong></em>. This is used to read only one column at a time from a dump file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.lammps_reader_helper</span> <span class="kn">import</span> <span class="n">read_additions</span>

<span class="c1"># ncol starts in python style, i.e. from 0</span>
<span class="n">dumpfile</span> <span class="o">=</span><span class="s1">&#39;./tests/sample_test_data/test_additional_columns.dump&#39;</span>
<span class="n">read_additions</span><span class="p">(</span><span class="n">dumpfile</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">reader.simulation_log.read_lammpslog</span></code> can extract the thermodynamic quantities from lammps log file, input with <code class="docutils literal notranslate"><span class="pre">filename</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>) lammps log file name, and return list of pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> for each logging section:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.simulation_log</span> <span class="kn">import</span> <span class="n">read_lammpslog</span>

<span class="n">read_lammpslog</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="writer.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Write LAMMPS dump/data format header</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Yuan-Chao Hu
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Reading Computer Simulations Snapshots</a><ul>
<li><a class="reference internal" href="#input-arguments">Input Arguments</a></li>
<li><a class="reference internal" href="#return">Return</a></li>
<li><a class="reference internal" href="#important-notes">Important Notes</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>