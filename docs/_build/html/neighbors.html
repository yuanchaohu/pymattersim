

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Neighbors &mdash; PyMatterSim  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Pair Correlation Function" href="gr.html" />
    <link rel="prev" title="Write LAMMPS dump/data format header" href="writer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyMatterSim
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="reader.html">Reading Computer Simulations Snapshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="writer.html">Write LAMMPS dump/data format header</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Neighbors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#i-reading-neighbors">I. Reading Neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ii-calculating-neighbors">II. Calculating Neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nnearests">1. Nnearests()</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cutoffneighbors">2. cutoffneighbors()</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cutoffneighbors-particletype">3. cutoffneighbors_particletype()</a></li>
<li class="toctree-l2"><a class="reference internal" href="#iii-freud-neighbors">III. Freud Neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#convert-configuration">1. convert_configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cal-neighbors">2. cal_neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#iv-voro-direct-neighbors">IV. Voro++ direct neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-input">1. <code class="docutils literal notranslate"><span class="pre">get_input()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#cal-voro">2. <code class="docutils literal notranslate"><span class="pre">cal_voro()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#voronowalls">3. <code class="docutils literal notranslate"><span class="pre">voronowalls()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#indicehis">4. <code class="docutils literal notranslate"><span class="pre">indicehis()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gr.html">Pair Correlation Function</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gr.html#gr-class">1. <code class="docutils literal notranslate"><span class="pre">gr</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="gr.html#getresults"><code class="docutils literal notranslate"><span class="pre">getresults()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="gr.html#conditional-gr">2. <code class="docutils literal notranslate"><span class="pre">conditional_gr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sq.html">Structure Factor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sq.html#sq-class">1. <code class="docutils literal notranslate"><span class="pre">sq</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="sq.html#getresults"><code class="docutils literal notranslate"><span class="pre">getresults()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="sq.html#conditional-sq">2. <code class="docutils literal notranslate"><span class="pre">conditional_sq()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="boo_2d.html">Bond Orientational Order Parameters at 2D</a><ul>
<li class="toctree-l2"><a class="reference internal" href="boo_2d.html#boo-2d-class">1. <code class="docutils literal notranslate"><span class="pre">boo_2d</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_2d.html#lthorder">2. <code class="docutils literal notranslate"><span class="pre">lthorder()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_2d.html#time-average">3. <code class="docutils literal notranslate"><span class="pre">time_average()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_2d.html#spatial-corr">4. <code class="docutils literal notranslate"><span class="pre">spatial_corr()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_2d.html#time-corr">5. <code class="docutils literal notranslate"><span class="pre">time_corr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="boo_3d.html">Bond Orientational Order Parameters at 3D</a><ul>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#boo-3d-class">1. <code class="docutils literal notranslate"><span class="pre">boo_3d</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#qlm-qlm">2. <code class="docutils literal notranslate"><span class="pre">qlm_Qlm()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#ql-ql">3. <code class="docutils literal notranslate"><span class="pre">ql_Ql()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#sij-ql-ql">4. <code class="docutils literal notranslate"><span class="pre">sij_ql_Ql()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#w-w-cap">5. <code class="docutils literal notranslate"><span class="pre">w_W_cap()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#spatial-corr">6. <code class="docutils literal notranslate"><span class="pre">spatial_corr()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#inputs">Inputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#time-corr">7. <code class="docutils literal notranslate"><span class="pre">time_corr()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="boo_3d.html#id1">Inputs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html">Static orderings</a><ul>
<li class="toctree-l2"><a class="reference internal" href="orderings.html#local-tetrahedral-order-q-rm-tetra">1. Local tetrahedral order <span class="math notranslate nohighlight">\(q_{\rm tetra}\)</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#input-arguments">1.1 Input Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#return">1.2 Return</a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#example">1.3 Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="orderings.html#packing-capability-theta-o">2. Packing capability <span class="math notranslate nohighlight">\(\Theta_o\)</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#id1">2.1 Input Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#id2">2.2 Return</a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#id3">2.3 Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="orderings.html#pair-entropy-s-2">3. Pair entropy <span class="math notranslate nohighlight">\(S_2\)</span></a><ul>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#s2-class"><code class="docutils literal notranslate"><span class="pre">S2</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#particle-s2"><code class="docutils literal notranslate"><span class="pre">particle_S2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#spatial-corr"><code class="docutils literal notranslate"><span class="pre">spatial_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#time-corr"><code class="docutils literal notranslate"><span class="pre">time_corr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="orderings.html#gyration-tensor-of-a-group">4. Gyration tensor of a group</a></li>
<li class="toctree-l2"><a class="reference internal" href="orderings.html#nematic-order">5. Nematic order</a><ul>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#nematicorder-class">5.1 <code class="docutils literal notranslate"><span class="pre">NematicOrder()</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#tensor">5.2 <code class="docutils literal notranslate"><span class="pre">tensor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#id4">5.3 <code class="docutils literal notranslate"><span class="pre">spatial_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="orderings.html#id5">5.4 <code class="docutils literal notranslate"><span class="pre">time_corr()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dynamics.html">Dynamical properties at two &amp; three dimensions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#cage-relative"><code class="docutils literal notranslate"><span class="pre">cage_relative()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#dynamics-class">1. <code class="docutils literal notranslate"><span class="pre">Dynamics()</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#relaxation">1.1 <code class="docutils literal notranslate"><span class="pre">relaxation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#sq4">1.2 <code class="docutils literal notranslate"><span class="pre">sq4()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#logdynamics-class">2. <code class="docutils literal notranslate"><span class="pre">LogDynamics()</span></code> class</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#id1">2.1 <code class="docutils literal notranslate"><span class="pre">relaxation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#time-correlation">3. <code class="docutils literal notranslate"><span class="pre">time_correlation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamics.html#input">Input:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">Hessian matrix calculation and diagonalization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hessian.html#i-pair-interactions">I. Pair interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="hessian.html#pairinteractions-class">1. <code class="docutils literal notranslate"><span class="pre">PairInteractions</span></code> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#caller">1.1 <code class="docutils literal notranslate"><span class="pre">caller()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#input">Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#lennard-jones">1.2 <code class="docutils literal notranslate"><span class="pre">lennard_jones()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#id1">Input</a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#inverse-power-law">1.3 <code class="docutils literal notranslate"><span class="pre">inverse_power_law()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#inputs">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#harmonic-hertz">1.4 <code class="docutils literal notranslate"><span class="pre">harmonic_hertz()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#id2">Inputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hessian.html#ii-hessian-matrix">II. Hessian matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#hessianmatrix-class">2. <code class="docutils literal notranslate"><span class="pre">HessianMatrix</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#pair-matrix">2.1 <code class="docutils literal notranslate"><span class="pre">pair_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#id3">Inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="hessian.html#diagonalize-hessian">2.2 <code class="docutils literal notranslate"><span class="pre">diagonalize_hessian()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html">vector analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="vectors.html#participation-ratio">1. participation ratio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vectors.html#input-argument">Input Argument</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vectors.html#local-vector-alignment">2. local vector alignment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vectors.html#id1">Input Argument</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vectors.html#phase-quotient">3. phase quotient</a><ul>
<li class="toctree-l3"><a class="reference internal" href="vectors.html#id2">Input Argument</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vectors.html#divergence-and-curl">4. divergence and curl</a></li>
<li class="toctree-l2"><a class="reference internal" href="vectors.html#vibrability">5. vibrability</a></li>
<li class="toctree-l2"><a class="reference internal" href="vectors.html#vector-decompostion-structure-factor">6. vector decompostion structure factor</a></li>
<li class="toctree-l2"><a class="reference internal" href="vectors.html#vectors-fourier-transformaiton-and-their-time-correlations">7. vectors Fourier transformaiton and their time correlations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">util functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utils.html#i-funcs">I. funcs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#nidealfac"><code class="docutils literal notranslate"><span class="pre">1.</span> <span class="pre">nidealfac()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#moment-of-inertia">2. <code class="docutils literal notranslate"><span class="pre">moment_of_inertia()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#ii-remove-pbc">II. Remove PBC</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#iii-geometry">III. geometry</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#triangle-area">1. <code class="docutils literal notranslate"><span class="pre">triangle_area()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#triangle-angle">2. <code class="docutils literal notranslate"><span class="pre">triangle_angle()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#lines-intersection">3. <code class="docutils literal notranslate"><span class="pre">lines_intersection()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#iv-wavevector">IV. wavevector</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#wavevector3d">1. <code class="docutils literal notranslate"><span class="pre">wavevector3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#wavevector2d">2. <code class="docutils literal notranslate"><span class="pre">wavevector2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#choosewavevector">3. <code class="docutils literal notranslate"><span class="pre">choosewavevector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#continuousvector">4. <code class="docutils literal notranslate"><span class="pre">continuousvector()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#v-fast-fourier-transformation">V. Fast Fourier Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#vi-spherical-harmonics">VI. Spherical Harmonics</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#vii-coarse-graining">VII. Coarse Graining</a><ul>
<li class="toctree-l3"><a class="reference internal" href="utils.html#time-average">1. <code class="docutils literal notranslate"><span class="pre">time_average()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#spatial-average">2. <code class="docutils literal notranslate"><span class="pre">spatial_average()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="utils.html#gaussian-blurring">3. <code class="docutils literal notranslate"><span class="pre">gaussian_blurring()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyMatterSim</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Neighbors</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/neighbors.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="neighbors">
<h1>Neighbors<a class="headerlink" href="#neighbors" title="Link to this heading"></a></h1>
<hr class="docutils" />
<p>This module reads the neighbor list from the saved file. The format of the saved neighbor list file (named as <em><strong>neighborlist.dat</strong></em> in default) must be identification of the centered particle (<em><strong>id</strong></em>), coordination number of the centered particle (<em><strong>cn</strong></em>), and identification of neighboring particles (<em><strong>neighborlist</strong></em>). That is, “<em><strong>id cn neighborlist</strong></em>”. The neighbors in the output file is sorted by their distances to the centered particle in ascending order.</p>
<p>This module is also heavily used to calculate the neighboring particles of a particle, or the properties about the neighboring list, which are the base for many different analyzing methods. There are many ways to recognize the neighbors, for example, by a certain number, by a certain cutoff, by particle-type specific cutoffs, by Voronoi tessellation (<a class="reference external" href="https://freud.readthedocs.io/en/latest/index.html">freud</a> or <a class="reference external" href="https://math.lbl.gov/voro++/">Voro++</a> directly) etc. This module covers the above calculation methods and can be easily extended by individual purpose. Neighbor list of different snapshots is continuous without any gap and all start with the header <em><strong>id cn neighborlist</strong></em>. This formatting is made to be consistent with reading neighbor lists for different analyzing methods.</p>
<section id="i-reading-neighbors">
<h2>I. Reading Neighbors<a class="headerlink" href="#i-reading-neighbors" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.read_neighbors.read_neighbors()</span></code> is used to read the property of neighboring particles from a saved file, as long as the format of file is compatible, as like <em><strong>neighborlist.dat</strong></em> (see below). Note that this module reads one snapshot a time to save computer memory. If you have multiple snapshots, you can import this module in a loop (see example).</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> (<code class="docutils literal notranslate"><span class="pre">TextIO</span></code>): opened file object which save the property of neighboring particles, <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">open(filename,</span> <span class="pre">'r',</span> <span class="pre">encoding='utf-8')</span></code>. Opening the file outside of the function ensures that when reading a file containing multiple snapshots, the file pointer can move to the next snapshot.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nmax</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): the maximum number of neighboring particles to consider. Setting <code class="docutils literal notranslate"><span class="pre">Nmax</span></code> to a sufficiently large value is ideal, with the default being 200. <code class="docutils literal notranslate"><span class="pre">Nmax</span></code> is defined to address the varying number of neighboring particles among different particles. In this way, we can create a regular two-dimensional NumPy array to save the property of neighboring particles.</p></li>
</ul>
<p><strong>Return</strong></p>
<p>two-dimensional numpy array, with shape (<code class="docutils literal notranslate"><span class="pre">nparticle</span></code>, <code class="docutils literal notranslate"><span class="pre">1+Nmax_fact</span></code>). <code class="docutils literal notranslate"><span class="pre">Nmax_fact</span></code> means the maximum coordination number for one particle in the system. The first column is the coordination number (<em><strong>cn</strong></em>). For particles with coordination number less than <code class="docutils literal notranslate"><span class="pre">Nmax_fact</span></code> (which is generally the case), the unoccupied positions in <code class="docutils literal notranslate"><span class="pre">neighborprop</span></code> (see source code) are padded with <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p><strong>Important Notes</strong></p>
<p>In the saved <em><strong>neighborlist.dat</strong></em>, the particle ID is counted from 1. While in this read module, the returned neighborlist is counted from 0. This is to facilitate subsequent indexing operations in python.</p>
<p><strong>Example</strong></p>
<ul>
<li><p>Read neighbor list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.read_neighbors</span> <span class="kn">import</span> <span class="n">read_neighbors</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">neighborprop</span> <span class="o">=</span> <span class="n">read_neighbors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nparticle</span><span class="o">=</span><span class="mi">8100</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Read facearea list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.read_neighbors</span> <span class="kn">import</span> <span class="n">read_neighbors</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.facearea.dat&#39;</span>	<span class="c1">### generated by carrying out Voronoi analysis module</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">neighborprop</span> <span class="o">=</span> <span class="n">read_neighbors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nparticle</span><span class="o">=</span><span class="mi">8100</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Read in multiple snapshots:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.read_neighbors</span> <span class="kn">import</span> <span class="n">read_neighbors</span>

<span class="n">neighbors_snapshots</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsnapshots</span><span class="p">):</span>	<span class="c1">### number of snapshots</span>
    <span class="n">neighbors_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">read_neighbors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nparticle</span><span class="o">=</span><span class="mi">8100</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">=</span><span class="mi">200</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="ii-calculating-neighbors">
<h2>II. Calculating Neighbors<a class="headerlink" href="#ii-calculating-neighbors" title="Link to this heading"></a></h2>
</section>
<section id="nnearests">
<h2>1. Nnearests()<a class="headerlink" href="#nnearests" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.calculate_neighbors.Nnearests()</span></code> gets the <code class="docutils literal notranslate"><span class="pre">N</span></code> nearest neighbors around a particle. In this case, the coordination number is <code class="docutils literal notranslate"><span class="pre">N</span></code> for each particle.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): the specified number of nearest neighbors, default 12</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting 1 for yes and 0 for no</p>
<p>default <code class="docutils literal notranslate"><span class="pre">np.array([1,1,1])</span></code>, that is, PBC is applied in all three dimensions for 3D box. Set <code class="docutils literal notranslate"><span class="pre">np.array([1,1])</span></code> for two-dimensional system.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fnfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the name of output file that stores the neighbor list, default <code class="docutils literal notranslate"><span class="pre">neighborlist.dat</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">Nnearests</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fnfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cutoffneighbors">
<h2>2. cutoffneighbors()<a class="headerlink" href="#cutoffneighbors" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.calculate_neighbors.cutoffneighbors()</span></code> gets the nearest neighbors around a particle by setting a global cutoff distance <code class="docutils literal notranslate"><span class="pre">r_cut</span></code>.  Usually, the cutoff distance can be determined as the position of the first deep well in total pair correlation function.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>):<code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r_cut</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): the global cutoff distance to screen the nearest neighbors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting 1 for yes and 0 for no</p>
<p>default <code class="docutils literal notranslate"><span class="pre">np.array([1,1,1])</span></code>, that is, PBC is applied in all three dimensions for 3D box. Set <code class="docutils literal notranslate"><span class="pre">np.array([1,1])</span></code> for two-dimensional system.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fnfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the name of output file that stores the neighbor list, default <code class="docutils literal notranslate"><span class="pre">neighborlist.dat</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">cutoffneighbors</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">cutoffneighbors</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">r_cut</span><span class="o">=</span><span class="mf">3.8</span><span class="p">,</span> <span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fnfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cutoffneighbors-particletype">
<h2>3. cutoffneighbors_particletype()<a class="headerlink" href="#cutoffneighbors-particletype" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.calculate_neighbors.cutoffneighbors_particletype()</span></code> gets the nearest neighbors around a particle by setting a cutoff distance <code class="docutils literal notranslate"> <span class="pre">r_cut</span></code>. Taken Cu-Zr system as an example, <code class="docutils literal notranslate"><span class="pre">r_cut</span></code> should be a 2D numpy array:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
  &amp;r_{\rm cut}^{\rm Cu-Cu} &amp; r_{\rm cut}^{\rm Cu-Zr}&amp;\\
  &amp;r_{\rm cut}^{\rm Zr-Cu} &amp; r_{\rm cut}^{\rm Zr-Zr}&amp;\\
\end{bmatrix}
\end{split}\]</div>
<p>Usually, these cutoff distances can be determined as the position of the individual first deep well in partial pair correlation function of each particle pair.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r_cut</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the cutoff distances of each particle pair</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting 1 for yes and 0 for no</p>
<p>default <code class="docutils literal notranslate"><span class="pre">np.array([1,1,1])</span></code>, that is, PBC is applied in all three dimensions for 3D box. Set <code class="docutils literal notranslate"><span class="pre">np.array([1,1])</span></code> for a two-dimensional system</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fnfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the name of output file that stores the neighbor list, default <code class="docutils literal notranslate"><span class="pre">neighborlist.dat</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">cutoffneighbors_particletype</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="c1">### a binary system</span>
<span class="n">r_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.6</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.4</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.4</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.9</span>
<span class="n">cutoffneighbors_particletype</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">r_cut</span><span class="o">=</span><span class="n">r_cut</span><span class="p">,</span> <span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fnfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="iii-freud-neighbors">
<h2>III. Freud Neighbors<a class="headerlink" href="#iii-freud-neighbors" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">freud</span></code> is a trajectory analysis package developed by <a class="reference external" href="https://freud.readthedocs.io/en/stable/index.html">Glotzer&amp;###39;s group</a>. To use <code class="docutils literal notranslate"><span class="pre">freud</span></code> easily, a function <code class="docutils literal notranslate"><span class="pre">neighbors.freud_neighbors.convert_configuration</span></code> is used to convert the dump file from our <code class="docutils literal notranslate"><span class="pre">reader</span></code> module to <code class="docutils literal notranslate"><span class="pre">freud</span></code> style. Correspondingly the list of box information and the list of the particle coordinates are returned for further analysis.</p>
</section>
<section id="convert-configuration">
<h2>1. convert_configuration<a class="headerlink" href="#convert-configuration" title="Link to this heading"></a></h2>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list_box</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the list of box information for <code class="docutils literal notranslate"><span class="pre">freud</span></code> analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list_points</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the list of particle positions for <code class="docutils literal notranslate"><span class="pre">freud</span></code> analysis</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.freud_neighbors</span> <span class="kn">import</span> <span class="n">convert_configuration</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">list_box</span><span class="p">,</span> <span class="n">list_points</span> <span class="o">=</span> <span class="n">convert_configuration</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cal-neighbors">
<h2>2. cal_neighbors<a class="headerlink" href="#cal-neighbors" title="Link to this heading"></a></h2>
<p>Calling <code class="docutils literal notranslate"><span class="pre">neighbors.freud_neighbors.Voro_neighbors()</span></code> first and then performing Voronoi analysis with <em><strong><a class="reference external" href="https://math.lbl.gov/voro++/">voro++</a></strong></em> package to calculate neighbors for both 2D and 3D systems. Three classes of information will be output:</p>
<ul class="simple">
<li><p>neighbor list: atom coordination and ids of each atom</p></li>
<li><p>Voronoi face area (3D) or edge length (2D) list: between the center and each of its neighbors</p></li>
<li><p>overall information: coordination number, Voronoi volume or area of each atom</p></li>
</ul>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename of neighbor list and bond info, such as edge length (2D) or facearea(3D), default <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p><strong>Return</strong></p>
<p>None (result is saved to file). For neighbor list, file with name outputfile+’.neighbor.dat’. For edgelength list (2D box), file with name outputfile+’.edgelength.dat’. For facearea list (3D box), file with name outputfile+’.facearea.dat’</p>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.lammps_reader_helper</span> <span class="kn">import</span> <span class="n">read_lammps_wrapper</span>
<span class="kn">from</span> <span class="nn">neighbors.freud_neighbors</span> <span class="kn">import</span> <span class="n">cal_neighbors</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump_2D.atom&#39;</span>
<span class="n">snapshots</span> <span class="o">=</span> <span class="n">read_lammps_wrapper</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cal_neighbors</span><span class="p">(</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s1">&#39;dump&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="iv-voro-direct-neighbors">
<h2>IV. Voro++ direct neighbors<a class="headerlink" href="#iv-voro-direct-neighbors" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors()</span></code> is used to perform radical Voronoi tessellation using <a class="reference external" href="https://math.lbl.gov/voro++/">voro++</a> for both PBC and non-PBC system.</p>
<p>The voro++ package considers non-periodic boundary conditions by default, so there may be some negative numbers in the neighbor list for non-periodic boundary conditions (please refer to the voro++ manual to know this well).</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors.voronowalls()</span></code>: used for any non-periodic boundary condition(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors.cal_voro()</span></code>: used for all periodic boundary conditions</p></li>
</ol>
</section>
<section id="get-input">
<h2>1. <code class="docutils literal notranslate"><span class="pre">get_input()</span></code><a class="headerlink" href="#get-input" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors.get_input()</span></code> is used to design input file for Voro++ by considering particle radii.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">radii</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): radii of particles, must be a dict like <code class="docutils literal notranslate"><span class="pre">{1</span> <span class="pre">:</span> <span class="pre">1.28,</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">1.60}</span> </code></p>
<p>if you do not want to consider radii, set the radii the same, default <code class="docutils literal notranslate"><span class="pre">{1:0.5,</span> <span class="pre">2:0.5}</span> </code></p>
</li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">position</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): input file for Voro++ with the format:</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): box bounds for snapshots</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.voronoi_neighbors</span> <span class="kn">import</span> <span class="n">get_input</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">get_input</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mf">1.0</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="cal-voro">
<h2>2. <code class="docutils literal notranslate"><span class="pre">cal_voro()</span></code><a class="headerlink" href="#cal-voro" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">voronoi.voropp.cal_voro()</span></code> is used to perform radical Voronoi tessellation if radii are given using voro++ for periodic boundary conditions.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Make the container periodic in all three directions, default <code class="docutils literal notranslate"><span class="pre">ppp='-p'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">radii</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): radii of particles, must be a dict like <code class="docutils literal notranslate"><span class="pre">{1</span> <span class="pre">:</span> <span class="pre">1.28,</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">1.60}</span> </code></p>
<p>if you do not want to consider radii, set the radii the same, default <code class="docutils literal notranslate"><span class="pre">{1:0.5,</span> <span class="pre">2:0.5}</span> </code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename of output, including <em>neighborlist</em>, <em>facearealist</em>, <em>voronoi index</em>, <em>overall</em> (facearea and volume of particle).</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> [saved to file]</p></li>
<li><p>for neighbor list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.neighbor.dat'</span></code></p></li>
<li><p>for facearea list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.facearea.dat'</span></code></p></li>
<li><p>for voronoi index, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.voroindex.dat'</span></code></p></li>
<li><p>for overall, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.overall.dat'</span></code></p></li>
</ul>
<p>Output files from <em><strong>voroindex</strong></em> and <em><strong>overall</strong></em> include a header for all snapshots. <em><strong>neighborlist</strong></em> and <em><strong>facearealist</strong></em> output files are in align with the format needed in the module <code class="docutils literal notranslate"><span class="pre">neighbors</span></code> and have headers for each individual snapshot.</p>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.lammps_reader_helper</span> <span class="kn">import</span> <span class="n">read_lammps_wrapper</span>
<span class="kn">from</span> <span class="nn">neighbors.voronoi_neighbors</span> <span class="kn">import</span> <span class="n">cal_voro</span>

<span class="n">test_file_3d</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">snapshots</span> <span class="o">=</span> <span class="n">read_lammps_wrapper</span><span class="p">(</span><span class="n">test_file_3d</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">cal_voro</span><span class="p">(</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s1">&#39;dump&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="voronowalls">
<h2>3. <code class="docutils literal notranslate"><span class="pre">voronowalls()</span></code><a class="headerlink" href="#voronowalls" title="Link to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">voronoi.voropp.voronowalls()</span></code> is used to perform radical Voronoi tessellation using voro++ for periodic boundary conditions.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Make the container periodic in a desired direction</p>
<p><code class="docutils literal notranslate"><span class="pre">'-px'</span></code>, <code class="docutils literal notranslate"><span class="pre">'-py'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'-pz'</span></code> for x, y, and z directions, respectively</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">radii</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): radii of particles, must be a dict like <code class="docutils literal notranslate"><span class="pre">{1</span> <span class="pre">:</span> <span class="pre">1.28,</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">1.60}</span> </code></p>
<p>if you do not want to consider radii, set the radii the same, default <code class="docutils literal notranslate"><span class="pre">{1:0.5,</span> <span class="pre">2:0.5}</span> </code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename of output, including <em>neighborlist</em>, <em>facearealist</em>, <em>voronoi index</em>, <em>overall</em> (facearea and volume of particle).</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> [saved to file]</p></li>
<li><p>for neighbor list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.neighbor.dat'</span></code></p></li>
<li><p>for facearea list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.facearea.dat'</span></code></p></li>
<li><p>for voronoi index, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.voroindex.dat'</span></code></p></li>
<li><p>for overall, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.overall.dat'</span></code></p></li>
</ul>
<p>Output files from <em><strong>voroindex</strong></em> and <em><strong>overall</strong></em> include a header for all snapshots. <em><strong>neighborlist</strong></em> and <em><strong>facearealist</strong></em> output files are in align with the format needed in the module <code class="docutils literal notranslate"><span class="pre">neighbors</span></code> and have headers for each individual snapshot.</p>
</section>
<section id="indicehis">
<h2>4. <code class="docutils literal notranslate"><span class="pre">indicehis()</span></code><a class="headerlink" href="#indicehis" title="Link to this heading"></a></h2>
<p>Statistics the frequency of voronoi index from the output of voronoi analysis. Only the top 50 voronoi index will be output along with their fractions.</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the filename of saved Voronoi index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the output filename of the frequency of voronoi index, default <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>None [saved to file], frequency of Voronoi Indices</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.voronoi_neighbors</span> <span class="kn">import</span> <span class="n">indicehis</span>

<span class="n">indicehis</span><span class="p">(</span><span class="s1">&#39;dump.voroindex.dat&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s1">&#39;voroindex_frction.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="writer.html" class="btn btn-neutral float-left" title="Write LAMMPS dump/data format header" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gr.html" class="btn btn-neutral float-right" title="Pair Correlation Function" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Yuan-Chao Hu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>