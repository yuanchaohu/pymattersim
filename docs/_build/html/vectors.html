<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="util functions" href="utils.html" /><link rel="prev" title="Hessian matrix calculation and diagonalization" href="hessian.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>vector analysis - PyMatterSim documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/furo.css?v=9ab603d5" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #1e88e5;
  --color-brand-content: #1e88e5;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMatterSim  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">PyMatterSim  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="reader.html">Reading Computer Simulations Snapshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="writer.html">Write LAMMPS dump/data format header</a></li>
<li class="toctree-l1"><a class="reference internal" href="neighbors.html">Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="gr.html">Pair Correlation Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="sq.html">Structure Factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_2d.html">Bond Orientational Order Parameters at 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_3d.html">Bond Orientational Order Parameters at 3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html">Static orderings</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamics.html">Dynamical properties at two &amp; three dimensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">Hessian matrix calculation and diagonalization</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">vector analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">util functions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/vectors.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="vector-analysis">
<h1>vector analysis<a class="headerlink" href="#vector-analysis" title="Link to this heading">¶</a></h1>
<hr class="docutils" />
<section id="participation-ratio">
<h2>1. participation ratio<a class="headerlink" href="#participation-ratio" title="Link to this heading">¶</a></h2>
<p>This module calculates the participation ratio of one vibration mode. It is measured as
$<span class="math notranslate nohighlight">\(
PR_n = \frac{\left[ \sum_i^N |\vec e_{i,n}|^2 \right]^2}
{N\sum_i ({\vec e_{i, n}} \cdot {\vec e_{i,n}})^2},
\)</span><span class="math notranslate nohighlight">\(
where \)</span>e_{i,n}<span class="math notranslate nohighlight">\( is the eigenvector of particle \)</span>i<span class="math notranslate nohighlight">\( in mode \)</span>n<span class="math notranslate nohighlight">\(. \)</span>N$ is the particle number.</p>
<section id="input-argument">
<h3>Input Argument<a class="headerlink" href="#input-argument" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vector</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): input vector field, shape as [num_of_particles, ndim]</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>participation ratio of the vector field (float)</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">static.vector</span> <span class="kn">import</span> <span class="n">participation_ratio</span>

<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;test.atom&quot;</span>
<span class="n">Readdump</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPSVECTOR</span><span class="p">,</span><span class="n">columnsids</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">Readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">test_file</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">participation_ratio</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="local-vector-alignment">
<h2>2. local vector alignment<a class="headerlink" href="#local-vector-alignment" title="Link to this heading">¶</a></h2>
<p>This module calculates the orientational ordering of each particle based on the vector alignments. It is measured as
$<span class="math notranslate nohighlight">\(
\Psi_i = \frac{1}{CN_i} \sum_j^{CN_i} {\vec e_i} \cdot {\vec e_j},
\)</span><span class="math notranslate nohighlight">\(
where \)</span>{\vec e_i}<span class="math notranslate nohighlight">\( is the eigenvector of particle \)</span>i<span class="math notranslate nohighlight">\( and \)</span>{CN_i}<span class="math notranslate nohighlight">\( is the number of neighbors of particle \)</span>i$.</p>
<section id="id1">
<h3>Input Argument<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vector</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): input vector field, shape as [num_of_particles, ndim]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighborfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): file name of particle neighbors (see module <code class="docutils literal notranslate"><span class="pre">neighbors</span></code>)</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>phase quotient measured as a <code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">static.vector</span> <span class="kn">import</span> <span class="n">local_vector_alignment</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>


<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;test.atom&quot;</span>
<span class="n">input_vp</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_vp</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">input_v</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPSVECTOR</span><span class="p">,</span><span class="n">columnsids</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">input_v</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">input_v</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>

<span class="n">Nnearests</span><span class="p">(</span><span class="n">input_vp</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">ppp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span>  <span class="n">fnfile</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
<span class="n">neighborfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span>

<span class="n">pr</span> <span class="o">=</span> <span class="n">local_vector_alignment</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">neighborfile</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="phase-quotient">
<h2>3. phase quotient<a class="headerlink" href="#phase-quotient" title="Link to this heading">¶</a></h2>
<p>This module calculates the phase quotient of a vector field. Maximum 200 neighbors are considered. It is defined as
$<span class="math notranslate nohighlight">\(
PQ_n = \frac{\sum_i^{N} \sum_j^{CN_i} {\vec e_{i, n}} \cdot {\vec e_{j, n}}}{\sum_i^{N} \sum_j^{CN_i} |{\vec e_{i, n}} \cdot {\vec e_{j, n}}|}.
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> are atom indices, <span class="math notranslate nohighlight">\(N\)</span> is the total atom number, <span class="math notranslate nohighlight">\({CN_i}\)</span> is the coordination number of atom <span class="math notranslate nohighlight">\(i\)</span>, n is the mode number, <span class="math notranslate nohighlight">\(\vec e_{i, n}\)</span> is the eigenvector of atom <span class="math notranslate nohighlight">\(i\)</span> in mode <span class="math notranslate nohighlight">\(n\)</span>. The upper bound <span class="math notranslate nohighlight">\(PQ_n=1\)</span> means acoustic nature of the mode (an atom has the same direction as the neighbors), while the lower bound of -1 means optical nature of the mode (an atom has the opposite direction as the neighbors). If <span class="math notranslate nohighlight">\(PQ_n \gt 0\)</span>, the mode is acoustic-like otherwise is optical-like mode.</p>
<section id="id2">
<h3>Input Argument<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vector</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): input vector field, shape as [num_of_particles, ndim]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighborfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): file name of particle neighbors (see module neighbors)</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>phase quotient measured as a float</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">static.vector</span> <span class="kn">import</span> <span class="n">phase_quotient</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>

<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;test.atom&quot;</span>
<span class="n">input_vp</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_vp</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">input_v</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPSVECTOR</span><span class="p">,</span><span class="n">columnsids</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">input_v</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">input_v</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>

<span class="n">Nnearests</span><span class="p">(</span><span class="n">input_vp</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">ppp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span>  <span class="n">fnfile</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
<span class="n">neighborfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span>

<span class="n">pq</span> <span class="o">=</span> <span class="n">phase_quotient</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">neighborfile</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="divergence-and-curl">
<h2>4. divergence and curl<a class="headerlink" href="#divergence-and-curl" title="Link to this heading">¶</a></h2>
<p>This module calculates the divergence and curl of a vector field at 2D and 3D. Divergence is scalar over all dimensions. Curl only exists in 3D as a vector. Maximum 200 neighbors are considered. Differently, <strong>curl</strong> can only be defined 3D as a vector, its direction shows the local rotational direction while its magnitude means the amplitude of such motion.</p>
<p>Both divergence and curl can be defined anywhere in space within the vector field, so i and j in above equations can be any lattice position in space.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\({\rm divergence\ (scalar):\quad} div\ {\vec u_i} = \nabla \cdot {\vec u} = \frac{1}{N_i} \sum_j^{N_i} (\vec R_j - \vec R_i) \cdot (\vec u_j - \vec u_i)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\rm curl\ (vector):\quad} curl\ {\vec u_i} = \nabla \times {\vec u} = \frac{1}{N_i} \sum_j^{N_i} (\vec R_j - \vec R_i) \times (\vec u_j - \vec u_i)\)</span></p></li>
</ul>
<p>in which <span class="math notranslate nohighlight">\(\vec R_i\)</span> is the position vector of atom <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(\vec u_i\)</span> is the vector field (e.g. eigenvector) at atom <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(N_i\)</span> is the number of nearest neighbors of atom <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.SingleSnapshot</span></code>): snapshot object of input trajectory (returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): vector field shape as [num_of_partices, ndim], it determines the dimensionality of the calculation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting 1 for yes and 0 for no, default <code class="docutils literal notranslate"><span class="pre">np.array([1,1,1])</span></code>, set <code class="docutils literal notranslate"><span class="pre">np.array([1,1])</span></code> for two-dimensional systems</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighborfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): file name of particle neighbors (see module <code class="docutils literal notranslate"><span class="pre">neighbors</span></code>)</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>divergence and curl (only 3D) in numpy array of the input vector</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">static.vector</span> <span class="kn">import</span> <span class="n">divergence_curl</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>

<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;test.atom&quot;</span>
<span class="n">input_vp</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_vp</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">input_v</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPSVECTOR</span><span class="p">,</span><span class="n">columnsids</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">input_v</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">ppp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">Nnearests</span><span class="p">(</span><span class="n">input_vp</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">ppp</span> <span class="o">=</span> <span class="n">ppp</span><span class="p">,</span>  <span class="n">fnfile</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
<span class="n">neighborfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span>
        
<span class="n">v</span> <span class="o">=</span> <span class="n">input_v</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>
<span class="n">pq</span> <span class="o">=</span> <span class="n">divergence_curl</span><span class="p">(</span><span class="n">input_vp</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">v</span><span class="p">,</span><span class="n">ppp</span><span class="p">,</span><span class="n">neighborfile</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="vibrability">
<h2>5. vibrability<a class="headerlink" href="#vibrability" title="Link to this heading">¶</a></h2>
<p>This calculates the susceptibility of particle motion to infinitesimal thermal excitation in the zero temperature limit, defined as:
$<span class="math notranslate nohighlight">\(
\Psi_i = \sum_{l=1}^{dN-d} \frac{1}{\omega_l^2} |{\vec e}_{l, i}|^2,
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(\omega_l^2\)</span> is the eigenvalue of the lth mode, while <span class="math notranslate nohighlight">\({\vec e}_{l, i}\)</span> is the corresponding eigenvector for particle <span class="math notranslate nohighlight">\(i\)</span>. Larger <span class="math notranslate nohighlight">\(\Psi\)</span> indicates more susceptible to excitation and hence more disorder.</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">eigenfrequencies</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): eigen frequencies generally from Hessian diagonalization, shape as [num_of_modes,]</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eigenvectors</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): eigen vectors associated with eigenfrequencies, each column represents an eigen mode as from <code class="docutils literal notranslate"><span class="pre">np.linalg.eig</span></code> method</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>particle-level vibrability in a numpy array</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">static.vector</span> <span class="kn">import</span> <span class="n">vibrability</span>

<span class="c1">###example for 10x10 matrix</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="n">eigenfrequencies</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">eigenfrequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigenfrequencies</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
<span class="n">eigenfrequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">eigenfrequencies</span><span class="p">)</span>
<span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">eigenvectors</span><span class="o">.</span><span class="n">real</span>

<span class="n">vb</span> <span class="o">=</span> <span class="n">vibrability</span><span class="p">(</span><span class="n">eigenfrequencies</span><span class="p">,</span><span class="n">eigenvectors</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="vector-decompostion-structure-factor">
<h2>6. vector decompostion structure factor<a class="headerlink" href="#vector-decompostion-structure-factor" title="Link to this heading">¶</a></h2>
<p>Decomposing the vector into transverse and longitudinal components and calculate their corresponding stucture factor.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
{\rm Longitudinal:} \qquad
S_L (q, \omega) = \frac{k_B T}{M} \left(\frac{q}{\omega} \right)^2 \sum_{\lambda=1}^{dN-d} E_{\lambda, L} (\mathbf{q}) \delta(\omega - \omega_{\lambda})
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
{\rm Transverse:} \qquad
S_T (q, \omega) = \frac{k_B T}{M} \left(\frac{q}{\omega} \right)^2 \sum_{\lambda=1}^{dN-d} E_{\lambda, T} (\mathbf{q}) \delta(\omega - \omega_{\lambda})
\]</div>
</div>
<p>where</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
E_{\lambda, L} (\bf{q}) = \frac{1}{N} \left| \sum_{i=1}^N \left(\bf{\hat q} \cdot \frac{\bf{e}_i^{\lambda}}{\sqrt{m_i}} \right) \cdot \exp(i \bf{q} \cdot \bf{r}_i) \right|^2
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
E_{\lambda, T} (\bf{q}) = \frac{1}{N} \left| \sum_{i=1}^N \left(\bf{\hat q} \times \frac{\bf{e}_i^{\lambda}}{\sqrt{m_i}} \right) \cdot \exp(i \bf{q} \cdot \bf{r}_i) \right|^2
\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(\bf \hat q = \bf q/|\bf q|\)</span>, <span class="math notranslate nohighlight">\(m_i\)</span> and <span class="math notranslate nohighlight">\(\bf{r}_i\)</span> are the mass and positional vector in the inherent structure of particle <span class="math notranslate nohighlight">\(i\)</span>. The average mass is approximated as <span class="math notranslate nohighlight">\(M^{-1} = \sum_l m_l^{-1} /N_l
\)</span> in which <span class="math notranslate nohighlight">\(l\)</span> runs over all species. The code calculates <span class="math notranslate nohighlight">\(E(q)\)</span>.</p>
<p>Another faster method is first taking the FFT of the eigenvector and then take dot product for the longitudinal component and cross product for the transverse component, as
$<span class="math notranslate nohighlight">\(
\tilde e = \sum_{i=1}^N \frac{\bf{e}_i^{\lambda}}{\sqrt{m_i}} \cdot \exp(i \bf{q} \cdot \bf{r}_i)
\)</span>$</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
E_{\lambda, L} (\bf{q}) = \frac{1}{N} \left| \hat{\bf{q}} \cdot \tilde e \right|^2
\]</div>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
E_{\lambda, T} (\bf{q}) = \frac{1}{N} \left| \hat{\bf{q}} \times \tilde e \right|^2
\]</div>
</div>
<p>This new method is utilized in the calculation. Basically, the vector field is first Fourier transformed and then decomposed into transverse and longitudinal components. The corresponding structure factor is then calculated.</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshot</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.SingleSnapshot</span></code>): single snapshot object of input trajectory</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qvector</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code> of <code class="docutils literal notranslate"><span class="pre">int</span></code>): designed wavevectors in two-dimensional <code class="docutils literal notranslate"><span class="pre">np.array</span></code> (see <code class="docutils literal notranslate"><span class="pre">utils.wavevector</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle-level vector, shape as [num_of_particles, ndim], for example, eigenvector field and velocity field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename.csv to save the calculated <code class="docutils literal notranslate"><span class="pre">S(q)</span></code>, default <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vector_fft</span></code>: calculated transverse and longitudinal <code class="docutils literal notranslate"><span class="pre">S(q)</span></code> for each input wavevector (<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>), FFT in complex number is also returned for reference</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ave_sqresults</span></code>: the ensemble averaged <code class="docutils literal notranslate"><span class="pre">S(q)</span></code> over the same wavenumber (<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>)</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">static.vector</span> <span class="kn">import</span> <span class="n">vector_decomposition_sq</span>
<span class="kn">from</span> <span class="nn">utils.wavevector</span> <span class="kn">import</span> <span class="n">choosewavevector</span>

<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;test.atom&quot;</span>

<span class="n">input_vp</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_vp</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">input_v</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPSVECTOR</span><span class="p">,</span><span class="n">columnsids</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">input_v</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">input_v</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>

<span class="n">qvector</span> <span class="o">=</span> <span class="n">choosewavevector</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">vector_fft</span><span class="p">,</span> <span class="n">ave_sqresults</span><span class="o">=</span><span class="n">vector_decomposition_sq</span><span class="p">(</span><span class="n">input_vp</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">qvector</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="vectors-fourier-transformaiton-and-their-time-correlations">
<h2>7. vectors Fourier transformaiton and their time correlations<a class="headerlink" href="#vectors-fourier-transformaiton-and-their-time-correlations" title="Link to this heading">¶</a></h2>
<p>This module calculates spectra and time correlation of the longitudinal and tranverse components of a vector field by fast fourier transformation (FFT). This is usually used to calculate the current-current correlation function and its power spectra. This is also useful to calculate the dynamic structure factor based on the velocity field.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\vec j (\vec q, t) = \sum_{m=1}^N \vec v_m(t) \exp[i \vec q \cdot \vec r_m(t)],
\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\vec v_m(t)\)</span> is the vector of particle <span class="math notranslate nohighlight">\(m\)</span> at time <span class="math notranslate nohighlight">\(t\)</span>, and <span class="math notranslate nohighlight">\(\vec r_m(t)\)</span> is the particle position.. It is decomposed into transverse and longitudinal components as
$<span class="math notranslate nohighlight">\(
\vec j_L (\vec q, t) = (\vec j (\vec q, t) \cdot \mathbf{\hat q}) \cdot \mathbf{\hat q}
\qquad\qquad
\vec j_T (\vec q, t) = \vec j (\vec q, t) - \vec j_L (\vec q, t)
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat q}\)</span> is the unit vector <span class="math notranslate nohighlight">\({\bf \hat q}={\vec q}/|{\bf q}|\)</span>.</p>
<p>The ensemble averaged power spectra is calculated as
$<span class="math notranslate nohighlight">\(
E_L (q) = \left &lt; \frac{1}{N} \left| \vec j_L(\vec q, t) \right|^2 \right&gt;
\qquad\qquad\qquad
E_T (q) = \left &lt; \frac{1}{N} \left| \vec j_T(\vec q, t) \right|^2 \right&gt;
\)</span>$</p>
<p>and the time correlation functions are calculated as
$<span class="math notranslate nohighlight">\(
C_\alpha(q, t)= \frac{1}{N} \left&lt; \vec j_\alpha({\vec q}, t) \cdot \vec j_\alpha(-{\vec q}, 0) \right&gt;
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> represents longitudinal (<span class="math notranslate nohighlight">\(L\)</span>) or transverse (<span class="math notranslate nohighlight">\(T\)</span>) current.</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">read.reader_utils.snapshots</span></code>): multiple trajectories dumped linearly or in logscale</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qvector</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code> of <code class="docutils literal notranslate"><span class="pre">int</span></code>): designed wavevectors in two-dimensional <code class="docutils literal notranslate"><span class="pre">np.array</span></code> (see <code class="docutils literal notranslate"><span class="pre">utils.wavevector</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vectors</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle-level vector, shape as [num_of_snapshots, num_of_particles, ndim], for example, eigenvector field and velocity field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): time step of input snapshots, default 0.002</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename.csv to save the calculated <code class="docutils literal notranslate"><span class="pre">S(q)</span></code>, default <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>the averaged spectra of full, transverse, and longitudinal mode, saved into a csv dataset</p></li>
<li><p>time correlation of FFT of vectors in full, transverse, and longitudinal mode. Dict as <code class="docutils literal notranslate"><span class="pre">{&quot;FFT&quot;:</span> <span class="pre">pd.DataFrame,</span> <span class="pre">&quot;T_FFT&quot;:</span> <span class="pre">pd.DataFrame,</span> <span class="pre">&quot;L_FFT&quot;:</span> <span class="pre">pd.DataFrame}</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">static.vector</span> <span class="kn">import</span> <span class="n">vector_fft_corr</span>
<span class="kn">from</span> <span class="nn">utils.wavevector</span> <span class="kn">import</span> <span class="n">choosewavevector</span>

<span class="n">test_file</span> <span class="o">=</span> <span class="s2">&quot;test.atom&quot;</span>
<span class="n">input_vp</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_vp</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">input_v</span> <span class="o">=</span><span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPSVECTOR</span><span class="p">,</span><span class="n">columnsids</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="n">input_v</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">qvector</span> <span class="o">=</span> <span class="n">choosewavevector</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">input_v</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">nsnapshots</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">input_v</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>
    <span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
<span class="n">v</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="n">alldata</span> <span class="o">=</span> <span class="n">vector_fft_corr</span><span class="p">(</span><span class="n">input_vp</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span><span class="n">qvector</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">outputfile</span><span class="o">=</span><span class="s2">&quot;test&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="utils.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">util functions</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="hessian.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Hessian matrix calculation and diagonalization</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Yuan-Chao Hu
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">vector analysis</a><ul>
<li><a class="reference internal" href="#participation-ratio">1. participation ratio</a><ul>
<li><a class="reference internal" href="#input-argument">Input Argument</a></li>
</ul>
</li>
<li><a class="reference internal" href="#local-vector-alignment">2. local vector alignment</a><ul>
<li><a class="reference internal" href="#id1">Input Argument</a></li>
</ul>
</li>
<li><a class="reference internal" href="#phase-quotient">3. phase quotient</a><ul>
<li><a class="reference internal" href="#id2">Input Argument</a></li>
</ul>
</li>
<li><a class="reference internal" href="#divergence-and-curl">4. divergence and curl</a></li>
<li><a class="reference internal" href="#vibrability">5. vibrability</a></li>
<li><a class="reference internal" href="#vector-decompostion-structure-factor">6. vector decompostion structure factor</a></li>
<li><a class="reference internal" href="#vectors-fourier-transformaiton-and-their-time-correlations">7. vectors Fourier transformaiton and their time correlations</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>