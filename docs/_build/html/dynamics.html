<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Hessian matrix calculation and diagonalization" href="hessian.html" /><link rel="prev" title="Static orderings" href="orderings.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Dynamical properties at two &amp; three dimensions - PyMatterSim documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/furo.css?v=9ab603d5" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #1e88e5;
  --color-brand-content: #1e88e5;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMatterSim  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">PyMatterSim  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="reader.html">Reading Computer Simulations Snapshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="writer.html">Write LAMMPS dump/data format header</a></li>
<li class="toctree-l1"><a class="reference internal" href="neighbors.html">Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="gr.html">Pair Correlation Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="sq.html">Structure Factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_2d.html">Bond Orientational Order Parameters at 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_3d.html">Bond Orientational Order Parameters at 3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html">Static orderings</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Dynamical properties at two &amp; three dimensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">Hessian matrix calculation and diagonalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html">vector analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">util functions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/dynamics.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="dynamical-properties-at-two-three-dimensions">
<h1>Dynamical properties at two &amp; three dimensions<a class="headerlink" href="#dynamical-properties-at-two-three-dimensions" title="Link to this heading">¶</a></h1>
<p>This module calculates the dynamical properties at different dimensions. It contains two different calculation classes:</p>
<ul class="simple">
<li><p>linear dynamics (<code class="docutils literal notranslate"><span class="pre">Dynamics()</span></code>) [snapshots are dumped in a linear manner]</p></li>
<li><p>log dynamics (<code class="docutils literal notranslate"><span class="pre">LogDynamics()</span></code>) [snapshots are dumped in a log scale]</p></li>
</ul>
<p>To calculate the atomic-scale dynamics, the absolute coordinates, for example, the ‘xu,yu,zu’ type in LAMMPS, are preferred, without dealing with the periodic boundary conditions. This is done by providing the trajectories through the variable <code class="docutils literal notranslate"><span class="pre">xudump</span></code>. Nevertheless, the other coordinates are acceptable. There cases are included:</p>
<ol class="arabic simple">
<li><p>Providing ‘xu’ type trajectory to <code class="docutils literal notranslate"><span class="pre">xudump</span></code> and ‘x’ or ‘xs’ type trajectory to <code class="docutils literal notranslate"><span class="pre">xdump</span></code>; the absolute coordinates from <code class="docutils literal notranslate"><span class="pre">xudump</span></code> will be used to calculate the dynamical quantities like displacement vector while the wrapped positions from <code class="docutils literal notranslate"><span class="pre">xdump</span></code> will be used only for calculating the dynamical structure factor <code class="docutils literal notranslate"><span class="pre">Sq4()</span></code>.</p></li>
<li><p>Providing only ‘xu’ type trajectory to <code class="docutils literal notranslate"><span class="pre">xudump</span></code> and set <code class="docutils literal notranslate"><span class="pre">None</span></code> to <code class="docutils literal notranslate"><span class="pre">xdump</span></code>; the absolute positions from <code class="docutils literal notranslate"><span class="pre">xudump</span></code> will be used to calculate all the quantities.</p></li>
<li><p>Providing only ‘x’ or ‘xs’ type trajectory to <code class="docutils literal notranslate"><span class="pre">xdump</span></code> and set <code class="docutils literal notranslate"><span class="pre">None</span></code> to <code class="docutils literal notranslate"><span class="pre">xudump</span></code>; the wrapped positions from <code class="docutils literal notranslate"><span class="pre">xdump</span></code> will be used to calculate all the quantities, by considering periodic boundary conditions (setting the correct <code class="docutils literal notranslate"><span class="pre">ppp</span></code> argument). This is not recommended and should be avoided for calculating mean-square displacements related quantities at long time scales.</p></li>
</ol>
<section id="cage-relative">
<h2><code class="docutils literal notranslate"><span class="pre">cage_relative()</span></code><a class="headerlink" href="#cage-relative" title="Link to this heading">¶</a></h2>
<p>Getting the cage-relative or coarse-grained displacement vectors of the center particle with respect to the neighbors in a certain range for single configuration.
The coarse-graining is done based on the given the neighboring particles, which are accessible by the <code class="docutils literal notranslate"><span class="pre">neighbors</span></code> module. Specifically,
$<span class="math notranslate nohighlight">\(
\Delta {\vec r_j} = \left[{\vec r_j} (t) - {\vec r_j}(0) \right] - \frac{1}{N_j}\sum_{i}^{N_j} \left[ {\vec r_i}(t) - {\vec r_i}(0) \right],
\)</span><span class="math notranslate nohighlight">\(
in which \)</span>j<span class="math notranslate nohighlight">\( is the center particle and \)</span>i$ is its neighbor.</p>
<p><strong>Input Arguments</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RII</span></code>(<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): original (absolute) displacement matrix with shape <code class="docutils literal notranslate"><span class="pre">[num_of_particles,</span> <span class="pre">ndim]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cnlist</span></code>(<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): neighbor list of the initial or reference configuration with shape <code class="docutils literal notranslate"><span class="pre">[num_of_particles,</span> <span class="pre">num_of_neighbors]</span></code>. This gives the particle identifiers (<span class="math notranslate nohighlight">\(i\)</span>) for each center (<span class="math notranslate nohighlight">\(j\)</span>). It available from the ‘neighbors’ module.</p></li>
</ul>
<p><strong>Return</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RII_relative</span></code>(<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): cage-relative displacement matrix with shape <code class="docutils literal notranslate"><span class="pre">[num_of_particles,</span> <span class="pre">ndim]</span></code> (the same as the input <code class="docutils literal notranslate"><span class="pre">RII</span></code>)</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamic.dynamics</span> <span class="kn">import</span> <span class="n">cage_relative</span>
<span class="kn">from</span> <span class="nn">neighbors.read_neighbors</span> <span class="kn">import</span> <span class="n">read_neighbors</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">###here is a example of how it works, it used within Dynamics and LogDynamics class</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">neighborfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span>
<span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">snapshots</span> <span class="o">=</span> <span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span>
<span class="n">Nnearests</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">ppp</span><span class="o">=</span><span class="n">ppp</span><span class="p">,</span>  <span class="n">fnfile</span><span class="o">=</span><span class="n">neighborfile</span><span class="p">)</span>

<span class="n">neighborlists</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">if</span> <span class="n">neighborfile</span><span class="p">:</span>
    <span class="n">fneighbor</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">neighborfile</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">snapshots</span><span class="o">.</span><span class="n">nsnapshots</span><span class="p">):</span>
        <span class="n">medium</span> <span class="o">=</span> <span class="n">read_neighbors</span><span class="p">(</span>
            <span class="n">f</span><span class="o">=</span><span class="n">fneighbor</span><span class="p">,</span>
            <span class="n">nparticle</span><span class="o">=</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">nparticle</span><span class="p">,</span>
            <span class="n">Nmax</span><span class="o">=</span><span class="mi">30</span>
        <span class="p">)</span>
        <span class="n">neighborlists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">medium</span><span class="p">)</span>
    <span class="n">fneighbor</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
<span class="n">pos_init</span> <span class="o">=</span> <span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">10</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>
<span class="n">pos_end</span> <span class="o">=</span> <span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span>
<span class="n">RII</span> <span class="o">=</span> <span class="n">pos_end</span> <span class="o">-</span> <span class="n">pos_init</span>
<span class="n">cage_relative</span><span class="p">(</span><span class="n">RII</span><span class="p">,</span><span class="n">neighborlists</span><span class="p">[</span><span class="mi">10</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="dynamics-class">
<h2>1. <code class="docutils literal notranslate"><span class="pre">Dynamics()</span></code> class<a class="headerlink" href="#dynamics-class" title="Link to this heading">¶</a></h2>
<p>This module calculates particle-level dynamical quantities with absolute or wrapped coordinates. It considers both two-dimensional systems and three-dimensional system, and for both absolute and cage-relative dynamics.</p>
<p>This module recommends to use absolute coordinates (like ‘xu’ in LAMMPS) to calculate particle-level displacement vectors, such as mean-squared displacements, while PBC is taken care of others as well.
The functions are listed below.</p>
<p><strong>Input Arguments</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xu_snapshots</span></code>(<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): snapshot object of input trajectory (returned by reader.dump_reader.DumpReader)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_snapshots</span></code>(<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): snapshot object of input trajectory (returned by reader.dump_reader.DumpReader)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code>(<code class="docutils literal notranslate"><span class="pre">float</span></code>): timestep used in user simulations, default 0.002</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting <code class="docutils literal notranslate"><span class="pre">1</span></code> for yes and <code class="docutils literal notranslate"><span class="pre">0</span></code> for no, default <code class="docutils literal notranslate"><span class="pre">np.array([0,0,0])</span></code> for 3D. It requires to be precisely given to determine the model dimensionality.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diameters</span></code> (<code class="docutils literal notranslate"><span class="pre">dict[int,</span> <span class="pre">float]</span></code>): map particle types to particle diameters, for example, <code class="docutils literal notranslate"><span class="pre">{1:</span> <span class="pre">1.0,</span> <span class="pre">2:1.5}</span></code> for binary systems.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>(<code class="docutils literal notranslate"><span class="pre">float</span></code>): mobility cutoff scaling factor, used together with <code class="docutils literal notranslate"><span class="pre">diameters</span></code> to determine the cutoff for each particle type, default 0.3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cal_type</span></code>(<code class="docutils literal notranslate"><span class="pre">str</span></code>): calculation type for the dynamical structure factor, can be either <code class="docutils literal notranslate"><span class="pre">slow</span></code>(default) or <code class="docutils literal notranslate"><span class="pre">fast</span></code>, accounting for the slow and fast dynamics.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighborfile</span></code>(<code class="docutils literal notranslate"><span class="pre">str</span></code>): neighbor list filename for coarse-graining, only provided when calculating (cage-)relative displacements.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_neighbors</span></code>(<code class="docutils literal notranslate"><span class="pre">int</span></code>): maximum of particle neighbors considered, default 30.</p></li>
</ul>
<p><strong>Return</strong>:</p>
<ul class="simple">
<li><p>None</p></li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamic.dynamics</span> <span class="kn">import</span> <span class="n">Dynamics</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>

<span class="c1">### example for 2d dump</span>
<span class="c1">### read the dump file</span>
<span class="n">file_2d_x</span> <span class="o">=</span> <span class="s2">&quot;2ddump.s.atom&quot;</span>
<span class="n">input_x</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">file_2d_x</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_x</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">file_2d_xu</span> <span class="o">=</span> <span class="s2">&quot;2ddump.u.atom&quot;</span>
<span class="n">input_xu</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">file_2d_xu</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_xu</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="c1">###calculate the neighbor, neighborlist can also be None</span>
<span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Nnearests</span><span class="p">(</span><span class="n">input_x</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">ppp</span> <span class="o">=</span> <span class="n">ppp</span><span class="p">,</span>  <span class="n">fnfile</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
<span class="n">neighborfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span> <span class="c1">###or None</span>

<span class="n">dynamic</span> <span class="o">=</span> <span class="n">Dynamics</span><span class="p">(</span><span class="n">xu_snapshots</span><span class="o">=</span><span class="n">input_xu</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span>
                   <span class="n">x_snapshots</span><span class="o">=</span><span class="n">input_x</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span>
                   <span class="n">dt</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> 
                   <span class="n">ppp</span><span class="o">=</span><span class="n">ppp</span><span class="p">,</span>
                   <span class="n">diameters</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mf">1.0</span><span class="p">},</span>
                   <span class="n">a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                   <span class="n">cal_type</span> <span class="o">=</span> <span class="s2">&quot;slow&quot;</span><span class="p">,</span>
                   <span class="n">neighborfile</span><span class="o">=</span><span class="n">neighborfile</span><span class="p">,</span>
                   <span class="n">max_neighbors</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="relaxation">
<h2>1.1 <code class="docutils literal notranslate"><span class="pre">relaxation()</span></code><a class="headerlink" href="#relaxation" title="Link to this heading">¶</a></h2>
<p>Compute self-intermediate scattering functions ISF,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
F_s(q,t) = \frac{1}{N} \bigg\langle \sum_{j=1}^{N}\exp\lbrack iq \cdot ({\bf r}_j(t)-{\bf r}_j(0))\rbrack\bigg\rangle \tag{1}.
\]</div>
</div>
<p>Overlap function <span class="math notranslate nohighlight">\(Q(t)\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
Q(t) = \frac{1}{N} \bigg\langle \sum_{j = 1}^{N}\omega\left( \left| \mathbf{r}_j\left( t \right) - \mathbf{r}_j\left( 0 \right) \right| \right) \bigg\rangle \tag{2},
\]</div>
</div>
<p>in which <span class="math notranslate nohighlight">\(\omega(x)=1\)</span> if <span class="math notranslate nohighlight">\(x&lt;cuoff\)</span> for slow dynamics or <span class="math notranslate nohighlight">\(x&gt;cutoff\)</span> for fast dynamics, else <span class="math notranslate nohighlight">\(\omega(x)=0\)</span>. This is related to the input argument <code class="docutils literal notranslate"><span class="pre">cal_type</span></code>. Its corresponding dynamic susceptibility <span class="math notranslate nohighlight">\(X_4(t)\)</span> is defined as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\chi_{4}\left( t \right) = N^{- 1}\left\lbrack \left\langle {Q\left( t \right)}^{2} \right\rangle - \left\langle Q\left( t \right) \right\rangle^{2} \right\rbrack
\tag{3},
\]</div>
</div>
<p>in which the quantity <span class="math notranslate nohighlight">\(Q(t)\)</span> should be non-averaged value.</p>
<p>The mean-squared displacement is defined by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\langle \Delta {r^2}(t)\rangle = \frac{1}{N} \bigg \langle \sum_{j=1}^{N} \lbrack {\bf r}_j(t)-{\bf r}_j(0) \rbrack ^2 \bigg \rangle
\tag{4},
\]</div>
</div>
<p>in which the prefered coordiantes are the absolute one, given by ‘xudump’.</p>
<p>The non-Gaussion parameter <span class="math notranslate nohighlight">\(\alpha_2(t)\)</span> is defined as</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[
\alpha_{2}\left( t \right) = \frac{3\left\langle \Delta r^{4}\left( t \right) \right\rangle}{5\left\langle \Delta r^{2}\left( t \right) \right\rangle^{2}} - 1\left( 3D \right); 
\qquad
\alpha_{2}\left( t \right) = \frac{\left\langle \Delta r^{4}\left( t \right) \right\rangle}{2\left\langle \Delta r^{2}\left( t \right) \right\rangle^{2}} - 1\left( 2D \right)
\tag{5},
\]</div>
</div>
<p>which is usually used to measure the degree of dynamical heterogeneity in the disordered states revealed by the particle-level mobility.</p>
<p><strong>Input Arguments</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">qconst</span></code>(<code class="docutils literal notranslate"><span class="pre">float</span></code>): the wavenumber factor for calculating self-intermediate scattering function. default <span class="math notranslate nohighlight">\(2\pi\)</span>, used internally as <code class="docutils literal notranslate"><span class="pre">qconst/diameters</span></code> to define the wavenumber for each particle. For example, if input <code class="docutils literal notranslate"><span class="pre">qconst=2PI</span></code> and <code class="docutils literal notranslate"><span class="pre">diamter=1.0</span></code> then the used wavenumber is <code class="docutils literal notranslate"><span class="pre">2PI/1.0</span></code>. This setting provides flexibility for polydisperse systems or considering dynamics differently for different particle types.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code>(<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle-level selection with the shape <code class="docutils literal notranslate"><span class="pre">[num_of_snapshots,</span> <span class="pre">num_of_particles]</span></code> , preferring the <code class="docutils literal notranslate"><span class="pre">bool</span></code> type. Default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code>(<code class="docutils literal notranslate"><span class="pre">str</span></code>): file name to save the calculated dynamics results</p></li>
</ul>
<p><strong>Return</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">results</span></code>(<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>): Calculated dynamics results</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">###calculate the particle-level condition, can alos be None</span>
<span class="n">condition</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">snapshot</span> <span class="ow">in</span> <span class="n">input_x</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">:</span>
    <span class="n">condition</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">snapshot</span><span class="o">.</span><span class="n">particle_type</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>
<span class="n">condition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">condition</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">dynamic</span><span class="o">.</span><span class="n">relaxation</span><span class="p">(</span><span class="n">qconst</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sq4">
<h2>1.2 <code class="docutils literal notranslate"><span class="pre">sq4()</span></code><a class="headerlink" href="#sq4" title="Link to this heading">¶</a></h2>
<p>Compute four-point dynamical structure factor of specific atoms at a characteristic timescale. The atoms can exhibit fast or slow dynamics, given by the input argument <code class="docutils literal notranslate"><span class="pre">cal_type</span></code>. It is defined in the same spirit as the static structure factor as below:
$<span class="math notranslate nohighlight">\(
S_4\left( q,t \right) = N^{- 1}\left\langle W\left( \mathbf{q},t \right)W\left( - \mathbf{q},t \right) \right\rangle, 
\)</span><span class="math notranslate nohighlight">\(
in which 
\)</span><span class="math notranslate nohighlight">\(
  W\left( \mathbf{q},t \right) = \sum_{j = 1}^{N}{\exp\left\lbrack i\mathbf{q} \cdot \mathbf{r}_{j}\left( 0 \right) \right\rbrack\omega\left( \left| \mathbf{r}_j\left( t \right) - \mathbf{r}_j\left( 0 \right) \right| \right)}, 
\)</span><span class="math notranslate nohighlight">\(
which is essentially the same as the quantity \)</span>Q(t)$ as above, accounting for the slow or fast dynamics at the particle level. The calculation is done in the same way as above.</p>
<p><strong>Input Arguments</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): characteristic time, typically peak time of <span class="math notranslate nohighlight">\(\chi_4(t)\)</span>, see self.relaxation()</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qrange</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): the wave number range to be calculated, default 10.0. It determines how many wavevector is involved in the computation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle-level condition / property, shape <code class="docutils literal notranslate"><span class="pre">[num_of_snapshots,</span> <span class="pre">num_of_particles]</span></code>. This supplements the fast or slow dynamics, for example, to calculate the slow dynamics of particles with type=1 will require this <code class="docutils literal notranslate"><span class="pre">condition</span></code> to be a <code class="docutils literal notranslate"><span class="pre">bool</span></code> type with <code class="docutils literal notranslate"><span class="pre">True</span></code> only for particle type of 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): output filename for the calculated dynamical structure factor</p></li>
</ul>
<p><strong>Return</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">results</span></code>(<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>): calculated dynamical structure factor</p></li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dynamic</span><span class="o">.</span><span class="n">sq4</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">qrange</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="logdynamics-class">
<h2>2. <code class="docutils literal notranslate"><span class="pre">LogDynamics()</span></code> class<a class="headerlink" href="#logdynamics-class" title="Link to this heading">¶</a></h2>
<p>This module is designed to calculate the dynamical properties of a trajectory as above but dumped in a log scale. It uses the ‘log’ style to output the atomic trajectory. Therefore, no ensemble-average is performed. The first configuration is the only one used to consider the particle neighbors and as the reference for calculating the dynamics.</p>
<p>Ensemble average is absent compared to the above <code class="docutils literal notranslate"><span class="pre">Dynamics()</span></code> class!</p>
<p><strong>Input Arguments</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xu_snapshots</span></code>(<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): snapshot object of input trajectory (returned by reader.dump_reader.DumpReader)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x_snapshots</span></code>(<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): snapshot object of input trajectory (returned by reader.dump_reader.DumpReader)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code>(<code class="docutils literal notranslate"><span class="pre">float</span></code>): timestep used in user simulations, default 0.002</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting <code class="docutils literal notranslate"><span class="pre">1</span></code> for yes and <code class="docutils literal notranslate"><span class="pre">0</span></code> for no, default <code class="docutils literal notranslate"><span class="pre">np.array([0,0,0])</span></code> for 3D. It requires to be precisely given to determine the model dimensionality.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diameters</span></code> (<code class="docutils literal notranslate"><span class="pre">dict[int,</span> <span class="pre">float]</span></code>): map particle types to particle diameters, for example, <code class="docutils literal notranslate"><span class="pre">{1:</span> <span class="pre">1.0,</span> <span class="pre">2:1.5}</span></code> for binary systems.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>(<code class="docutils literal notranslate"><span class="pre">float</span></code>): mobility cutoff scaling factor, used together with <code class="docutils literal notranslate"><span class="pre">diameters</span></code> to determine the cutoff for each particle type, default 0.3.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cal_type</span></code>(<code class="docutils literal notranslate"><span class="pre">str</span></code>): calculation type for the dynamical structure factor, can be either <code class="docutils literal notranslate"><span class="pre">slow</span></code>(default) or <code class="docutils literal notranslate"><span class="pre">fast</span></code>, accounting for the slow and fast dynamics.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighborfile</span></code>(<code class="docutils literal notranslate"><span class="pre">str</span></code>): neighbor list filename for coarse-graining, only provided when calculating (cage-)relative displacements.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_neighbors</span></code>(<code class="docutils literal notranslate"><span class="pre">int</span></code>): maximum of particle neighbors considered, default 30.</p></li>
</ul>
<p><strong>Return</strong>:</p>
<ul class="simple">
<li><p>None</p></li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamic.dynamics</span> <span class="kn">import</span> <span class="n">LogDynamics</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>

<span class="c1">### example for 2d dump</span>
<span class="c1">### read the dump file</span>
<span class="n">file_2d_x</span> <span class="o">=</span> <span class="s2">&quot;2ddump.log.s.atom&quot;</span>
<span class="n">input_x</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">file_2d_x</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_x</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">file_2d_xu</span> <span class="o">=</span> <span class="s2">&quot;2ddump.log.u.atom&quot;</span>
<span class="n">input_xu</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">file_2d_xu</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">input_xu</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="c1">###calculate the neighbor, neighborlist can also be None</span>
<span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">Nnearests</span><span class="p">(</span><span class="n">input_x</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="n">ppp</span> <span class="o">=</span> <span class="n">ppp</span><span class="p">,</span>  <span class="n">fnfile</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
<span class="n">neighborfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span>

<span class="n">log_dynamic</span> <span class="o">=</span> <span class="n">LogDynamics</span><span class="p">(</span><span class="n">xu_snapshots</span><span class="o">=</span><span class="n">input_xu</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span>
                   <span class="n">x_snapshots</span><span class="o">=</span><span class="n">input_x</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span>
                   <span class="n">dt</span><span class="o">=</span><span class="mf">0.002</span><span class="p">,</span> 
                   <span class="n">ppp</span><span class="o">=</span><span class="n">ppp</span><span class="p">,</span>
                   <span class="n">diameters</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mf">1.0</span><span class="p">},</span>
                   <span class="n">a</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                   <span class="n">cal_type</span> <span class="o">=</span> <span class="s2">&quot;slow&quot;</span><span class="p">,</span>
                   <span class="n">neighborfile</span><span class="o">=</span><span class="n">neighborfile</span><span class="p">,</span>
                   <span class="n">max_neighbors</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>   
</pre></div>
</div>
</section>
<section id="id1">
<h2>2.1 <code class="docutils literal notranslate"><span class="pre">relaxation()</span></code><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<p>Compute the self-intermediate scattering functions ISF, overlap function Qt and set its corresponding dynamical susceptibility X4_Qt (<span class="math notranslate nohighlight">\(\chi_4(t)\)</span>) as 0, mean-square displacements msd, and non-Gaussion parameter <span class="math notranslate nohighlight">\(\alpha_2(t)\)</span></p>
<p><strong>Input Arguments</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">qconst</span></code>(<code class="docutils literal notranslate"><span class="pre">float</span></code>): the wavenumber factor for calculating self-intermediate scattering function. default <span class="math notranslate nohighlight">\(2\pi\)</span>, used internally as <code class="docutils literal notranslate"><span class="pre">qconst/diameters</span></code> to define the wavenumber for each particle. For example, if input <code class="docutils literal notranslate"><span class="pre">qconst=2PI</span></code> and <code class="docutils literal notranslate"><span class="pre">diamter=1.0</span></code> then the used wavenumber is <code class="docutils literal notranslate"><span class="pre">2PI/1.0</span></code>. This setting provides flexibility for polydisperse systems or considering dynamics differently for different particle types.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code>(<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle-level selection with the shape <code class="docutils literal notranslate"><span class="pre">[num_of_snapshots,</span> <span class="pre">num_of_particles]</span></code> , preferring the <code class="docutils literal notranslate"><span class="pre">bool</span></code> type. Default <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code>(<code class="docutils literal notranslate"><span class="pre">str</span></code>): file name to save the calculated dynamics results</p></li>
</ul>
<p><strong>Return</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">results</span></code>(<code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>): Calculated dynamics results</p></li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">###calculate the particle-level condition, can alos be None</span>
<span class="n">condition</span><span class="o">=</span><span class="p">[]</span>
<span class="n">condition</span><span class="o">=</span><span class="p">(</span><span class="n">input_xu</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">particle_type</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">dynamic</span><span class="o">.</span><span class="n">relaxation</span><span class="p">(</span><span class="n">qconst</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">condition</span><span class="o">=</span><span class="n">condition</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="time-correlation">
<h2>3. <code class="docutils literal notranslate"><span class="pre">time_correlation()</span></code><a class="headerlink" href="#time-correlation" title="Link to this heading">¶</a></h2>
<p>Calculate the time correlation of the input property given by condition</p>
<p>There are three cases considered, given by the shape of condition:</p>
<ol class="arabic simple">
<li><p>condition is float scalar type, for example, density</p></li>
<li><p>condition is float vector type, for example, velocity</p></li>
<li><p>condition is float tensor type, for example, nematic order</p></li>
</ol>
</section>
<section id="input">
<h2>Input:<a class="headerlink" href="#input" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">read.reader_utils.snapshots</span></code>): multiple trajectories dumped linearly or in logscale</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): particle-level condition / property, type should be float
shape: <code class="docutils literal notranslate"><span class="pre">[num_of_snapshots,</span> <span class="pre">num_of_particles,</span> <span class="pre">xxx]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): time step of input snapshots, default 0.002</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): output file name, default “” (None)</p></li>
</ul>
<p><strong>Return</strong>:</p>
<ul class="simple">
<li><p>calculated time-correlation information in pandas dataframe</p></li>
</ul>
<p><strong>Example</strong>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">###example for random scalar condition</span>
<span class="kn">from</span> <span class="nn">dynamic.time_corr</span> <span class="kn">import</span> <span class="n">time_correlation</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">test_file</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>
<span class="n">condition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">nsnapshots</span><span class="p">,</span> <span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">snapshots</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span>
<span class="n">tc</span> <span class="o">=</span> <span class="n">time_correlation</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span><span class="n">condition</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="hessian.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Hessian matrix calculation and diagonalization</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="orderings.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Static orderings</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Yuan-Chao Hu
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Dynamical properties at two &amp; three dimensions</a><ul>
<li><a class="reference internal" href="#cage-relative"><code class="docutils literal notranslate"><span class="pre">cage_relative()</span></code></a></li>
<li><a class="reference internal" href="#dynamics-class">1. <code class="docutils literal notranslate"><span class="pre">Dynamics()</span></code> class</a></li>
<li><a class="reference internal" href="#relaxation">1.1 <code class="docutils literal notranslate"><span class="pre">relaxation()</span></code></a></li>
<li><a class="reference internal" href="#sq4">1.2 <code class="docutils literal notranslate"><span class="pre">sq4()</span></code></a></li>
<li><a class="reference internal" href="#logdynamics-class">2. <code class="docutils literal notranslate"><span class="pre">LogDynamics()</span></code> class</a></li>
<li><a class="reference internal" href="#id1">2.1 <code class="docutils literal notranslate"><span class="pre">relaxation()</span></code></a></li>
<li><a class="reference internal" href="#time-correlation">3. <code class="docutils literal notranslate"><span class="pre">time_correlation()</span></code></a></li>
<li><a class="reference internal" href="#input">Input:</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>