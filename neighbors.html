<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Pair Correlation Function" href="gr.html" /><link rel="prev" title="Write LAMMPS dump/data format header" href="writer.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Neighbors - PyMatterSim documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #1e88e5;
  --color-brand-content: #1e88e5;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #bb86fc;
  --color-brand-content: #bb86fc;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">PyMatterSim  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">PyMatterSim  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="reader.html">Reading Computer Simulations Snapshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="writer.html">Write LAMMPS dump/data format header</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="gr.html">Pair Correlation Function</a></li>
<li class="toctree-l1"><a class="reference internal" href="sq.html">Structure Factor</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_2d.html">Bond Orientational Order Parameters at 2D</a></li>
<li class="toctree-l1"><a class="reference internal" href="boo_3d.html">Bond Orientational Order Parameters at 3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderings.html">Static orderings</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamics.html">Dynamical properties at two &amp; three dimensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="hessian.html">Hessian matrix calculation and diagonalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="vectors.html">vector analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">util functions</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/neighbors.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="neighbors">
<h1>Neighbors<a class="headerlink" href="#neighbors" title="Link to this heading">¶</a></h1>
<hr class="docutils" />
<p>This module <a class="reference internal" href="###Reading_Neighbors"><span class="xref myst">reads the neighbor list</span></a> from the saved file. The format of the saved neighbor list file (named as <em><strong>neighborlist.dat</strong></em> in default) must be identification of the centered particle (<em><strong>id</strong></em>), coordination number of the centered particle (<em><strong>cn</strong></em>), and identification of neighboring particles (<em><strong>neighborlist</strong></em>). That is, “<em><strong>id cn neighborlist</strong></em>”. The neighbors in the output file is sorted by their distances to the centered particle in ascending order.</p>
<p>This module is also heavily used to calculate the neighboring particles of a particle, or the properties about the neighboring list, which are the base for many different analyzing methods. There are many ways to recognize the neighbors, for example, by a <a class="reference internal" href="###1-nnearests"><span class="xref myst">certain number</span></a>, by a <a class="reference internal" href="###2-cutoffneighbors"><span class="xref myst">certain cutoff</span></a>, by <a class="reference internal" href="###3-cutoffneighbors_particletype"><span class="xref myst">particle-type specific cutoffs</span></a>, by Voronoi tessellation (<a class="reference external" href="https://freud.readthedocs.io/en/latest/index.html">freud</a> or <a class="reference external" href="https://math.lbl.gov/voro++/">Voro++</a> directly) etc. This module covers the above calculation methods and can be easily extended by individual purpose. Neighbor list of different snapshots is continuous without any gap and all start with the header <em><strong>id cn neighborlist</strong></em>. This formatting is made to be consistent with reading neighbor lists for different analyzing methods.</p>
<section id="i-reading-neighbors">
<h2>I. Reading Neighbors<a class="headerlink" href="#i-reading-neighbors" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.read_neighbors.read_neighbors()</span></code> is used to read the property of neighboring particles from a saved file, as long as the format of file is compatible, as like <em><strong>neighborlist.dat</strong></em> (see below). Note that this module reads one snapshot a time to save computer memory. If you have multiple snapshots, you can import this module in a loop (see example).</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> (<code class="docutils literal notranslate"><span class="pre">TextIO</span></code>): opened file object which save the property of neighboring particles, <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">open(filename,</span> <span class="pre">'r',</span> <span class="pre">encoding='utf-8')</span></code>. Opening the file outside of the function ensures that when reading a file containing multiple snapshots, the file pointer can move to the next snapshot.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nmax</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): the maximum number of neighboring particles to consider. Setting <code class="docutils literal notranslate"><span class="pre">Nmax</span></code> to a sufficiently large value is ideal, with the default being 200. <code class="docutils literal notranslate"><span class="pre">Nmax</span></code> is defined to address the varying number of neighboring particles among different particles. In this way, we can create a regular two-dimensional NumPy array to save the property of neighboring particles.</p></li>
</ul>
<p><strong>Return</strong></p>
<p>two-dimensional numpy array, with shape (<code class="docutils literal notranslate"><span class="pre">nparticle</span></code>, <code class="docutils literal notranslate"><span class="pre">1+Nmax_fact</span></code>). <code class="docutils literal notranslate"><span class="pre">Nmax_fact</span></code> means the maximum coordination number for one particle in the system. The first column is the coordination number (<em><strong>cn</strong></em>). For particles with coordination number less than <code class="docutils literal notranslate"><span class="pre">Nmax_fact</span></code> (which is generally the case), the unoccupied positions in <code class="docutils literal notranslate"><span class="pre">neighborprop</span></code> (see source code) are padded with <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p><strong>Important Notes</strong></p>
<p>In the saved <em><strong>neighborlist.dat</strong></em>, the particle ID is counted from 1. While in this read module, the returned neighborlist is counted from 0. This is to facilitate subsequent indexing operations in python.</p>
<p><strong>Example</strong></p>
<ul>
<li><p>Read neighbor list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.read_neighbors</span> <span class="kn">import</span> <span class="n">read_neighbors</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">neighborprop</span> <span class="o">=</span> <span class="n">read_neighbors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nparticle</span><span class="o">=</span><span class="mi">8100</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Read facearea list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.read_neighbors</span> <span class="kn">import</span> <span class="n">read_neighbors</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.facearea.dat&#39;</span>	<span class="c1">### generated by carrying out Voronoi analysis module</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">neighborprop</span> <span class="o">=</span> <span class="n">read_neighbors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nparticle</span><span class="o">=</span><span class="mi">8100</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Read in multiple snapshots:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.read_neighbors</span> <span class="kn">import</span> <span class="n">read_neighbors</span>

<span class="n">neighbors_snapshots</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;neighborlist.dat&#39;</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nsnapshots</span><span class="p">):</span>	<span class="c1">### number of snapshots</span>
    <span class="n">neighbors_snapshots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">read_neighbors</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">nparticle</span><span class="o">=</span><span class="mi">8100</span><span class="p">,</span> <span class="n">Nmax</span><span class="o">=</span><span class="mi">200</span><span class="p">))</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="ii-calculating-neighbors">
<h2>II. Calculating Neighbors<a class="headerlink" href="#ii-calculating-neighbors" title="Link to this heading">¶</a></h2>
</section>
<section id="nnearests">
<h2>1. Nnearests()<a class="headerlink" href="#nnearests" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.calculate_neighbors.Nnearests()</span></code> gets the <code class="docutils literal notranslate"><span class="pre">N</span></code> nearest neighbors around a particle. In this case, the coordination number is <code class="docutils literal notranslate"><span class="pre">N</span></code> for each particle.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): the specified number of nearest neighbors, default 12</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting 1 for yes and 0 for no</p>
<p>default <code class="docutils literal notranslate"><span class="pre">np.array([1,1,1])</span></code>, that is, PBC is applied in all three dimensions for 3D box. Set <code class="docutils literal notranslate"><span class="pre">np.array([1,1])</span></code> for two-dimensional system.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fnfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the name of output file that stores the neighbor list, default <code class="docutils literal notranslate"><span class="pre">neighborlist.dat</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">Nnearests</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">Nnearests</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fnfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cutoffneighbors">
<h2>2. cutoffneighbors()<a class="headerlink" href="#cutoffneighbors" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.calculate_neighbors.cutoffneighbors()</span></code> gets the nearest neighbors around a particle by setting a global cutoff distance <code class="docutils literal notranslate"><span class="pre">r_cut</span></code>.  Usually, the cutoff distance can be determined as the position of the first deep well in total pair correlation function.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>):<code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r_cut</span></code> (<code class="docutils literal notranslate"><span class="pre">float</span></code>): the global cutoff distance to screen the nearest neighbors</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting 1 for yes and 0 for no</p>
<p>default <code class="docutils literal notranslate"><span class="pre">np.array([1,1,1])</span></code>, that is, PBC is applied in all three dimensions for 3D box. Set <code class="docutils literal notranslate"><span class="pre">np.array([1,1])</span></code> for two-dimensional system.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fnfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the name of output file that stores the neighbor list, default <code class="docutils literal notranslate"><span class="pre">neighborlist.dat</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">cutoffneighbors</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">cutoffneighbors</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">r_cut</span><span class="o">=</span><span class="mf">3.8</span><span class="p">,</span> <span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fnfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cutoffneighbors-particletype">
<h2>3. cutoffneighbors_particletype()<a class="headerlink" href="#cutoffneighbors-particletype" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.calculate_neighbors.cutoffneighbors_particletype()</span></code> gets the nearest neighbors around a particle by setting a cutoff distance <code class="docutils literal notranslate"> <span class="pre">r_cut</span></code>. Taken Cu-Zr system as an example, <code class="docutils literal notranslate"><span class="pre">r_cut</span></code> should be a 2D numpy array:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
  &amp;r_{\rm cut}^{\rm Cu-Cu} &amp; r_{\rm cut}^{\rm Cu-Zr}&amp;\\
  &amp;r_{\rm cut}^{\rm Zr-Cu} &amp; r_{\rm cut}^{\rm Zr-Zr}&amp;\\
\end{bmatrix}
\end{split}\]</div>
</div>
<p>Usually, these cutoff distances can be determined as the position of the individual first deep well in partial pair correlation function of each particle pair.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r_cut</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the cutoff distances of each particle pair</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">npt.NDArray</span></code>): the periodic boundary conditions, setting 1 for yes and 0 for no</p>
<p>default <code class="docutils literal notranslate"><span class="pre">np.array([1,1,1])</span></code>, that is, PBC is applied in all three dimensions for 3D box. Set <code class="docutils literal notranslate"><span class="pre">np.array([1,1])</span></code> for a two-dimensional system</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">fnfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the name of output file that stores the neighbor list, default <code class="docutils literal notranslate"><span class="pre">neighborlist.dat</span></code></p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.calculate_neighbors</span> <span class="kn">import</span> <span class="n">cutoffneighbors_particletype</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="c1">### a binary system</span>
<span class="n">r_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.6</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.4</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.4</span>
<span class="n">r_cut</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.9</span>
<span class="n">cutoffneighbors_particletype</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">r_cut</span><span class="o">=</span><span class="n">r_cut</span><span class="p">,</span> <span class="n">ppp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fnfile</span><span class="o">=</span><span class="s1">&#39;neighborlist.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="iii-freud-neighbors">
<h2>III. Freud Neighbors<a class="headerlink" href="#iii-freud-neighbors" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">freud</span></code> is a trajectory analysis package developed by <a class="reference external" href="https://freud.readthedocs.io/en/stable/index.html">Glotzer&amp;###39;s group</a>. To use <code class="docutils literal notranslate"><span class="pre">freud</span></code> easily, a function <code class="docutils literal notranslate"><span class="pre">neighbors.freud_neighbors.convert_configuration</span></code> is used to convert the dump file from our <code class="docutils literal notranslate"><span class="pre">reader</span></code> module to <code class="docutils literal notranslate"><span class="pre">freud</span></code> style. Correspondingly the list of box information and the list of the particle coordinates are returned for further analysis.</p>
</section>
<section id="convert-configuration">
<h2>1. convert_configuration<a class="headerlink" href="#convert-configuration" title="Link to this heading">¶</a></h2>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list_box</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the list of box information for <code class="docutils literal notranslate"><span class="pre">freud</span></code> analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">list_points</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): the list of particle positions for <code class="docutils literal notranslate"><span class="pre">freud</span></code> analysis</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.freud_neighbors</span> <span class="kn">import</span> <span class="n">convert_configuration</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">list_box</span><span class="p">,</span> <span class="n">list_points</span> <span class="o">=</span> <span class="n">convert_configuration</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cal-neighbors">
<h2>2. cal_neighbors<a class="headerlink" href="#cal-neighbors" title="Link to this heading">¶</a></h2>
<p>Calling <code class="docutils literal notranslate"><span class="pre">neighbors.freud_neighbors.Voro_neighbors()</span></code> first and then performing Voronoi analysis with <em><strong><a class="reference external" href="https://math.lbl.gov/voro++/">voro++</a></strong></em> package to calculate neighbors for both 2D and 3D systems. Three classes of information will be output:</p>
<ul class="simple">
<li><p>neighbor list: atom coordination and ids of each atom</p></li>
<li><p>Voronoi face area (3D) or edge length (2D) list: between the center and each of its neighbors</p></li>
<li><p>overall information: coordination number, Voronoi volume or area of each atom</p></li>
</ul>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename of neighbor list and bond info, such as edge length (2D) or facearea(3D), default <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p><strong>Return</strong></p>
<p>None (result is saved to file). For neighbor list, file with name outputfile+’.neighbor.dat’. For edgelength list (2D box), file with name outputfile+’.edgelength.dat’. For facearea list (3D box), file with name outputfile+’.facearea.dat’</p>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.lammps_reader_helper</span> <span class="kn">import</span> <span class="n">read_lammps_wrapper</span>
<span class="kn">from</span> <span class="nn">neighbors.freud_neighbors</span> <span class="kn">import</span> <span class="n">cal_neighbors</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump_2D.atom&#39;</span>
<span class="n">snapshots</span> <span class="o">=</span> <span class="n">read_lammps_wrapper</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">cal_neighbors</span><span class="p">(</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s1">&#39;dump&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="iv-voro-direct-neighbors">
<h2>IV. Voro++ direct neighbors<a class="headerlink" href="#iv-voro-direct-neighbors" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors()</span></code> is used to perform radical Voronoi tessellation using <a class="reference external" href="https://math.lbl.gov/voro++/">voro++</a> for both PBC and non-PBC system.</p>
<p>The voro++ package considers non-periodic boundary conditions by default, so there may be some negative numbers in the neighbor list for non-periodic boundary conditions (please refer to the voro++ manual to know this well).</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors.voronowalls()</span></code>: used for any non-periodic boundary condition(s)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors.cal_voro()</span></code>: used for all periodic boundary conditions</p></li>
</ol>
</section>
<section id="get-input">
<h2>1. <code class="docutils literal notranslate"><span class="pre">get_input()</span></code><a class="headerlink" href="#get-input" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">neighbors.voronoi_neighbors.get_input()</span></code> is used to design input file for Voro++ by considering particle radii.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">radii</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): radii of particles, must be a dict like <code class="docutils literal notranslate"><span class="pre">{1</span> <span class="pre">:</span> <span class="pre">1.28,</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">1.60}</span> </code></p>
<p>if you do not want to consider radii, set the radii the same, default <code class="docutils literal notranslate"><span class="pre">{1:0.5,</span> <span class="pre">2:0.5}</span> </code></p>
</li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">position</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): input file for Voro++ with the format:</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bounds</span></code> (<code class="docutils literal notranslate"><span class="pre">list</span></code>): box bounds for snapshots</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.dump_reader</span> <span class="kn">import</span> <span class="n">DumpReader</span>
<span class="kn">from</span> <span class="nn">reader.reader_utils</span> <span class="kn">import</span> <span class="n">DumpFileType</span>
<span class="kn">from</span> <span class="nn">neighbors.voronoi_neighbors</span> <span class="kn">import</span> <span class="n">get_input</span>

<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">readdump</span> <span class="o">=</span> <span class="n">DumpReader</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">DumpFileType</span><span class="o">.</span><span class="n">LAMMPS</span><span class="p">,</span> <span class="n">moltypes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">readdump</span><span class="o">.</span><span class="n">read_onefile</span><span class="p">()</span>

<span class="n">get_input</span><span class="p">(</span><span class="n">readdump</span><span class="o">.</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mf">1.0</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="cal-voro">
<h2>2. <code class="docutils literal notranslate"><span class="pre">cal_voro()</span></code><a class="headerlink" href="#cal-voro" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">voronoi.voropp.cal_voro()</span></code> is used to perform radical Voronoi tessellation if radii are given using voro++ for periodic boundary conditions.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Make the container periodic in all three directions, default <code class="docutils literal notranslate"><span class="pre">ppp='-p'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">radii</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): radii of particles, must be a dict like <code class="docutils literal notranslate"><span class="pre">{1</span> <span class="pre">:</span> <span class="pre">1.28,</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">1.60}</span> </code></p>
<p>if you do not want to consider radii, set the radii the same, default <code class="docutils literal notranslate"><span class="pre">{1:0.5,</span> <span class="pre">2:0.5}</span> </code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename of output, including <em>neighborlist</em>, <em>facearealist</em>, <em>voronoi index</em>, <em>overall</em> (facearea and volume of particle).</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> [saved to file]</p></li>
<li><p>for neighbor list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.neighbor.dat'</span></code></p></li>
<li><p>for facearea list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.facearea.dat'</span></code></p></li>
<li><p>for voronoi index, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.voroindex.dat'</span></code></p></li>
<li><p>for overall, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.overall.dat'</span></code></p></li>
</ul>
<p>Output files from <em><strong>voroindex</strong></em> and <em><strong>overall</strong></em> include a header for all snapshots. <em><strong>neighborlist</strong></em> and <em><strong>facearealist</strong></em> output files are in align with the format needed in the module <code class="docutils literal notranslate"><span class="pre">neighbors</span></code> and have headers for each individual snapshot.</p>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">reader.lammps_reader_helper</span> <span class="kn">import</span> <span class="n">read_lammps_wrapper</span>
<span class="kn">from</span> <span class="nn">neighbors.voronoi_neighbors</span> <span class="kn">import</span> <span class="n">cal_voro</span>

<span class="n">test_file_3d</span> <span class="o">=</span> <span class="s1">&#39;dump.atom&#39;</span>
<span class="n">snapshots</span> <span class="o">=</span> <span class="n">read_lammps_wrapper</span><span class="p">(</span><span class="n">test_file_3d</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">cal_voro</span><span class="p">(</span><span class="n">snapshots</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s1">&#39;dump&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="voronowalls">
<h2>3. <code class="docutils literal notranslate"><span class="pre">voronowalls()</span></code><a class="headerlink" href="#voronowalls" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">voronoi.voropp.voronowalls()</span></code> is used to perform radical Voronoi tessellation using voro++ for periodic boundary conditions.</p>
<p><strong>Input Arguments</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">snapshots</span></code> (<code class="docutils literal notranslate"><span class="pre">reader.reader_utils.Snapshots</span></code>): <code class="docutils literal notranslate"><span class="pre">Snapshots</span></code> data class returned by <code class="docutils literal notranslate"><span class="pre">reader.dump_reader.DumpReader</span></code> from input configuration file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppp</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): Make the container periodic in a desired direction</p>
<p><code class="docutils literal notranslate"><span class="pre">'-px'</span></code>, <code class="docutils literal notranslate"><span class="pre">'-py'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'-pz'</span></code> for x, y, and z directions, respectively</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">radii</span></code> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): radii of particles, must be a dict like <code class="docutils literal notranslate"><span class="pre">{1</span> <span class="pre">:</span> <span class="pre">1.28,</span> <span class="pre">2</span> <span class="pre">:</span> <span class="pre">1.60}</span> </code></p>
<p>if you do not want to consider radii, set the radii the same, default <code class="docutils literal notranslate"><span class="pre">{1:0.5,</span> <span class="pre">2:0.5}</span> </code></p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): filename of output, including <em>neighborlist</em>, <em>facearealist</em>, <em>voronoi index</em>, <em>overall</em> (facearea and volume of particle).</p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> [saved to file]</p></li>
<li><p>for neighbor list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.neighbor.dat'</span></code></p></li>
<li><p>for facearea list, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.facearea.dat'</span></code></p></li>
<li><p>for voronoi index, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.voroindex.dat'</span></code></p></li>
<li><p>for overall, file with name <code class="docutils literal notranslate"><span class="pre">outputfile.overall.dat'</span></code></p></li>
</ul>
<p>Output files from <em><strong>voroindex</strong></em> and <em><strong>overall</strong></em> include a header for all snapshots. <em><strong>neighborlist</strong></em> and <em><strong>facearealist</strong></em> output files are in align with the format needed in the module <code class="docutils literal notranslate"><span class="pre">neighbors</span></code> and have headers for each individual snapshot.</p>
</section>
<section id="indicehis">
<h2>4. <code class="docutils literal notranslate"><span class="pre">indicehis()</span></code><a class="headerlink" href="#indicehis" title="Link to this heading">¶</a></h2>
<p>Statistics the frequency of voronoi index from the output of voronoi analysis. Only the top 50 voronoi index will be output along with their fractions.</p>
<p><strong>Input Arguments</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the filename of saved Voronoi index</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">outputfile</span></code> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): the output filename of the frequency of voronoi index, default <code class="docutils literal notranslate"><span class="pre">None</span></code></p></li>
</ul>
<p><strong>Return</strong></p>
<ul class="simple">
<li><p>None [saved to file], frequency of Voronoi Indices</p></li>
</ul>
<p><strong>Example</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">neighbors.voronoi_neighbors</span> <span class="kn">import</span> <span class="n">indicehis</span>

<span class="n">indicehis</span><span class="p">(</span><span class="s1">&#39;dump.voroindex.dat&#39;</span><span class="p">,</span> <span class="n">outputfile</span><span class="o">=</span><span class="s1">&#39;voroindex_frction.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="gr.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Pair Correlation Function</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="writer.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Write LAMMPS dump/data format header</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Yuan-Chao Hu
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Neighbors</a><ul>
<li><a class="reference internal" href="#i-reading-neighbors">I. Reading Neighbors</a></li>
<li><a class="reference internal" href="#ii-calculating-neighbors">II. Calculating Neighbors</a></li>
<li><a class="reference internal" href="#nnearests">1. Nnearests()</a></li>
<li><a class="reference internal" href="#cutoffneighbors">2. cutoffneighbors()</a></li>
<li><a class="reference internal" href="#cutoffneighbors-particletype">3. cutoffneighbors_particletype()</a></li>
<li><a class="reference internal" href="#iii-freud-neighbors">III. Freud Neighbors</a></li>
<li><a class="reference internal" href="#convert-configuration">1. convert_configuration</a></li>
<li><a class="reference internal" href="#cal-neighbors">2. cal_neighbors</a></li>
<li><a class="reference internal" href="#iv-voro-direct-neighbors">IV. Voro++ direct neighbors</a></li>
<li><a class="reference internal" href="#get-input">1. <code class="docutils literal notranslate"><span class="pre">get_input()</span></code></a></li>
<li><a class="reference internal" href="#cal-voro">2. <code class="docutils literal notranslate"><span class="pre">cal_voro()</span></code></a></li>
<li><a class="reference internal" href="#voronowalls">3. <code class="docutils literal notranslate"><span class="pre">voronowalls()</span></code></a></li>
<li><a class="reference internal" href="#indicehis">4. <code class="docutils literal notranslate"><span class="pre">indicehis()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>